<DataPipeModel description="Parse CM email Inbound Data for Charter Email Service" name="Adhoc CHTR E-Mail Parse CM Logs - Inbound v5" editBy="flow" is_init="false" useStreaming="auto" durableStreaming="false" streamingAutoStart="false" useHive="auto" batchDuration="P1M" checkpoint="" batchSampling="true" sparkMasterHost="">
  <HiveConfig>
    <Properties>
      <Property name="hive.warehouse.hdfs.source" value=""/>
      <Property name="hive.metastore.data.source" value=""/>
      <Property name="hive.server2.thrift.port" value=""/>
      <Property name="hive.db.schema" value=""/>
    </Properties>
  </HiveConfig>
  <ModelInfo validated="true">
    <Pipes>
      <Pipe index="1000" uuid="" name="(main)"/>
    </Pipes>
    <Flows>
      <Flow index="1000" uuid="Main" isNested="false" revision="784" name="Main" showFooter="true">
        <Node index="1001" uuid="d3e86d1f-8c60-4618-827e-966bc2afda90" type="Join" label="Filter Events of Interest" x="600" y="40" width="130" height="95">
          <Source name="source1" uid="0" outputType="DStream" dataType="class:Step7_Class">
            <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="b6a2b4e9-3f7a-4f33-8684-2794f67555f9">
              <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="action" label="action" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="dstmta" label="dstmta" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
            </DataSource>
          </Source>
          <Source name="source2" uid="1" outputType="DStream" dataType="(String,String,String,String,String)">
            <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="84d9b8fb-d76e-4d6b-87ae-5f6846925cec">
              <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_source_group" label="parse_source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_source_name" label="parse_source_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_target_app" label="parse_target_app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_target_metric" label="parse_target_metric" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
            </DataSource>
          </Source>
          <Output name="out" uid="0" outputType="DStream" dataType="class:Step4_Class">
            <Field name="reason" label="reason" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="ts" label="ts" type="datetime" clazz="" isArray="false" isOptional="false"/>
            <Field name="dstmta" label="dstmta" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="host" label="host" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="action" label="action" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="datekey" label="datekey" type="long" clazz="" isArray="false" isOptional="false"/>
            <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false"/>
            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
          </Output>
          <Model joinType="InnerJoin" _caseClass="Step4_Class" isClassRef="false" joinAlgorithms="broadcast">
            <Predicates sleText="source1.action = source2.parse_source_name"/>
            <ProjectionsEditor>
              <ProjectionInfo source="source1.reason" name="reason" level="1" exclude="false"/>
              <ProjectionInfo source="source1.ts" name="ts" level="1" exclude="false"/>
              <ProjectionInfo source="source1.action" name="action" level="1" exclude="false"/>
              <ProjectionInfo source="source1.host" name="host" level="1" exclude="false"/>
              <ProjectionInfo source="source1.dstmta" name="dstmta" level="1" exclude="false"/>
              <ProjectionInfo source="source1.datekey" name="datekey" level="1" exclude="false"/>
              <ProjectionInfo source="source2.aggr_func" name="aggr_func" level="1" exclude="false"/>
              <ProjectionInfo source="source2.parse_source_group" name="parse_source_group" level="1" exclude="false"/>
              <ProjectionInfo source="source2.parse_source_name" name="parse_source_name" level="1" exclude="false"/>
              <ProjectionInfo source="source2.parse_target_app" name="parse_target_app" level="1" exclude="false"/>
              <ProjectionInfo source="source2.parse_target_metric" name="parse_target_metric" level="1" exclude="false"/>
            </ProjectionsEditor>
            <Projections>
              <Projection source="source1.reason" name="reason" label="reason"/>
              <Projection source="source1.ts" name="ts" label="ts"/>
              <Projection source="source1.dstmta" name="dstmta" label="dstmta"/>
              <Projection source="source1.host" name="host" label="host"/>
              <Projection source="source1.action" name="action" label="action"/>
              <Projection source="source1.datekey" name="datekey" label="datekey"/>
              <Projection source="source2.aggr_func" name="aggr_func" label="aggr_func"/>
              <Projection source="source2.parse_source_group" name="parse_source_group" label="parse_source_group"/>
              <Projection source="source2.parse_source_name" name="parse_source_name" label="parse_source_name"/>
              <Projection source="source2.parse_target_app" name="parse_target_app" label="parse_target_app"/>
              <Projection source="source2.parse_target_metric" name="parse_target_metric" label="parse_target_metric"/>
            </Projections>
          </Model>
        </Node>
        <Node index="1002" uuid="6c378ec5-4ded-4a29-8ddf-eb56c81a3b29" type="Compute" label="Normalize Aggregated Output" x="1040" y="40" width="130" height="75">
          <Source name="source" uid="0" outputType="DStream" dataType="(Long,String,String,String,Long,String,String,String,String,Long,Long)">
            <DataSource category="#OUTPUT" id="undefined" name="ToNormalize" nodeId="3b53a717-9dbe-4351-813c-c90f108d2158">
              <Field name="_vt_time" label="_vt_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              <Field name="dstmta" label="dstmta" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              <Field name="parse_source_group" label="parse_source_group" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              <Field name="parse_target_app" label="parse_target_app" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              <Field name="parse_target_metric" label="parse_target_metric" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              <Field name="count" label="count" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              <Field name="window_start_time" label="window_start_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
            </DataSource>
          </Source>
          <Output name="out" uid="0" outputType="DStream" dataType="class:NormalizeAggregatedOutput_Class" cacheEnabled="true" storageLevel="MEMORY_ONLY_SER">
            <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
            <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
            <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
            <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
            <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="metric_value" label="metric_value" type="double" clazz="" isArray="false" isOptional="false"/>
            <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="host" label="host" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="dom" label="dom" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="dhost" label="dhost" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="reason" label="reason" type="string" clazz="" isArray="false" isOptional="false"/>
            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
          </Output>
          <Model _caseClass="NormalizeAggregatedOutput_Class" isClassRef="false">
            <Computes>
              <Compute op="sleText" field="*" arg="" value="window_start_time/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="_vt_time/1000" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="parse_target_app" outputType="string" alias="app" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="datekey" outputType="long" alias="date_key" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now()) / 1000" outputType="long" alias="system_tm" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="if(${stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="&apos;sum&apos;" outputType="string" alias="aggr_type" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="&apos;csv&apos;" outputType="string" alias="source_fmt" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="&apos;${timezone}&apos;" outputType="string" alias="source_tz" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="&apos;host|dom|dhost|reason&apos;" outputType="string" alias="ts_key" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="concat(host,&apos;|&apos;,&apos;&apos;,&apos;|&apos;,dstmta,&apos;|&apos;,reason)" outputType="string" alias="ts_value" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="parse_target_metric" outputType="string" alias="metric_name" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="cast(count, &apos;double&apos;)" outputType="double" alias="metric_value" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="aggr_func" outputType="string" alias="metric_uom" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="host" outputType="string" alias="host" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="&apos;&apos;" outputType="string" alias="dom" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="dstmta" outputType="string" alias="dhost" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="reason" outputType="string" alias="reason" wordWarp="true"/>
            </Computes>
            <CheckboxStatus isChecked="mixed"/>
          </Model>
        </Node>
        <Node index="1003" uuid="b6a2b4e9-3f7a-4f33-8684-2794f67555f9" type="Compute" label="Convert Timestamp" x="368" y="40" width="130" height="75">
          <Source name="source" uid="0" outputType="DStream" dataType="class:Step1_Class">
            <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="5f665fa4-8262-43a7-8ba3-e96e06444426">
              <Field name="_time" label="_time" type="double" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              <Field name="action" label="action" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              <Field name="helo" label="helo" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
              <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              <Field name="mc" label="mc" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
              <Field name="ph" label="ph" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
              <Field name="virus" label="virus" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
              <Field name="p" label="p" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
              <Field name="ph2" label="ph2" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
              <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
              <Field name="tag" label="tag" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
              <Field name="cc" label="cc" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
              <Field name="dstmta" label="dstmta" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
            </DataSource>
          </Source>
          <Output name="out" uid="0" outputType="DStream" dataType="class:Step7_Class">
            <Field name="ts" label="ts" type="datetime" clazz="" isArray="false" isOptional="false"/>
            <Field name="action" label="action" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="host" label="host" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="dstmta" label="dstmta" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="datekey" label="datekey" type="long" clazz="" isArray="false" isOptional="false"/>
            <Field name="reason" label="reason" type="string" clazz="" isArray="false" isOptional="false"/>
            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
          </Output>
          <Model _caseClass="Step7_Class" isClassRef="false" udfs="generate_datekey">
            <Variables>
              <Variable alias="varTs" outputType="datetime" value="from_unixtime_millisec(cast(`_time`*1000,&quot;Long&quot;))"/>
            </Variables>
            <Computes>
              <Compute op="sleText" field="*" arg="" value="varTs" outputType="datetime" alias="ts" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="concat(&apos;inbound.&apos;,action)" outputType="string" alias="action" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="host" outputType="string" alias="host" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="to_nonoption(dstmta,&quot;&quot;)" outputType="string" alias="dstmta" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="generate_datekey(varTs,&quot;${timezone}&quot;)" outputType="long" alias="datekey" wordWarp="true"/>
              <Compute op="sleText" field="*" arg="" value="to_nonoption(reason, &quot;&quot;)" outputType="string" alias="reason" wordWarp="true"/>
            </Computes>
            <CheckboxStatus isChecked="mixed"/>
          </Model>
        </Node>
        <Node index="1004" uuid="5f665fa4-8262-43a7-8ba3-e96e06444426" type="Parse" label="Parse CSV" x="180" y="40" width="130" height="95">
          <Source name="source" uid="0" outputType="DStream" dataType="String">
            <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="4a019801-4853-477a-862d-7a888462e914">
              <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
            </DataSource>
          </Source>
          <Output name="out" uid="0" outputType="DStream" dataType="class:Step1_Class">
            <Field name="_time" label="_time" type="double" isArray="false" isOptional="false"/>
            <Field name="action" label="action" type="string" isArray="false" isOptional="false"/>
            <Field name="helo" label="helo" type="string" isArray="false" isOptional="true"/>
            <Field name="host" label="host" type="string" isArray="false" isOptional="false"/>
            <Field name="mc" label="mc" type="string" isArray="false" isOptional="true"/>
            <Field name="ph" label="ph" type="string" isArray="false" isOptional="true"/>
            <Field name="virus" label="virus" type="string" isArray="false" isOptional="true"/>
            <Field name="p" label="p" type="string" isArray="false" isOptional="true"/>
            <Field name="ph2" label="ph2" type="string" isArray="false" isOptional="true"/>
            <Field name="reason" label="reason" type="string" isArray="false" isOptional="true"/>
            <Field name="tag" label="tag" type="string" isArray="false" isOptional="true"/>
            <Field name="cc" label="cc" type="string" isArray="false" isOptional="true"/>
            <Field name="dstmta" label="dstmta" type="string" isArray="false" isOptional="true"/>
            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
          </Output>
          <Output name="Dropped" uid="1" outputType="DStream" dataType="(String,String)">
            <Field name="___error___" label="error" type="string" isArray="false" isOptional="false"/>
            <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
          </Output>
          <Model format="csv" delimiterType="csv" caseClass="Step1_Class" isClassRef="false" fromHeader="true" addable="true" dropEvent="true" header="&quot;_time&quot;,action,helo,host,mc,ph,virus,p,ph,reason,tag,cc,dstmta" timezone="Etc/GMT+12" daylight="false">
            <Schema>
              <Field name="_time" initName="_time" label="_time" type="double" isDimension="false" isMeasure="false" isArray="false" isOptional="false" excluded="false"/>
              <Field name="action" initName="action" label="action" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" excluded="false"/>
              <Field name="helo" initName="helo" label="helo" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true" excluded="false"/>
              <Field name="host" initName="host" label="host" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" excluded="false"/>
              <Field name="mc" initName="mc" label="mc" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true" excluded="false"/>
              <Field name="ph" initName="ph" label="ph" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true" excluded="false"/>
              <Field name="virus" initName="virus" label="virus" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true" excluded="false"/>
              <Field name="p" initName="p" label="p" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true" excluded="false"/>
              <Field name="ph2" initName="ph" label="ph2" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true" excluded="false"/>
              <Field name="reason" initName="reason" label="reason" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true" excluded="false"/>
              <Field name="tag" initName="tag" label="tag" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true" excluded="false"/>
              <Field name="cc" initName="cc" label="cc" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true" excluded="false"/>
              <Field name="dstmta" initName="dstmta" label="dstmta" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true" excluded="false"/>
            </Schema>
          </Model>
        </Node>
        <Node index="1005" uuid="84d9b8fb-d76e-4d6b-87ae-5f6846925cec" type="subflow" label="MetricReferenceData" x="460" y="180" width="130" height="75">
          <Output name="Out" uid="0" outputType="DStream" dataType="(String,String,String,String,String)">
            <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false"/>
            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
          </Output>
          <Model>
            <Properties>
{&quot;subFlow&quot;:&quot;remote:///viaops.ingestion/MetricReferenceData&quot;,&quot;dataSource&quot;:{&quot;dataSource&quot;:&quot;/vitria/m3o/datasource/DefaultDomain/charter_ref_db&quot;},&quot;ref_table&quot;:&quot;charter_service_model&quot;,&quot;ref_source_group&quot;:&quot;stva_video&quot;,&quot;ref_filterScript&quot;:&quot;parse_source_group=&apos;${source_group}&apos; and parse_target_app=&apos;cm&apos;&quot;,&quot;poll&quot;:&quot;1&quot;}
</Properties>
            <__subflow__>
              <Flow index="1005" uuid="MetricReferenceData" isNested="true" revision="549" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/MetricReferenceData" name="MetricReferenceData" showFooter="true">
                <Node index="1005_1" uuid="6029ac79-48d9-4e91-8d5f-bf6b1e7cc197" type="JDBCStream" label="Load System Model" x="46" y="20" width="130" height="75">
                  <Output name="out" uid="0" outputType="DStream" dataType="class:SystemModelData">
                    <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model type="jdbcStream" sourceType="jdbc" caseClass="SystemModelData" isClassRef="true" dataSpeed="" dataVolume="" dataSource="/vitria/m3o/datasource/DefaultDomain/charter_ref_db">
                    <__binding__><![CDATA[{"dataSource":"dataSource","databaseList":"","tableList":"ref_table"}]]></__binding__>
                    <Schema>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false" wrapName="metric_id"/>
                      <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false" wrapName="aggr_func"/>
                      <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false" wrapName="parse_source_group"/>
                      <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false" wrapName="parse_source_name"/>
                      <Field name="parse_target_group" label="parse_target_group" type="string" clazz="" isArray="false" isOptional="false" wrapName="parse_target_group"/>
                      <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false" wrapName="parse_target_app"/>
                      <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false" wrapName="parse_target_metric"/>
                      <Field name="modified_ts" label="modified_ts" type="datetime" clazz="" isArray="false" isOptional="false" wrapName="modified_ts"/>
                    </Schema>
                    <datasource name="/vitria/m3o/datasource/DefaultDomain/charter_ref_db"/>
                    <query>
                      <table schema="charter_ref_db" defaultSchema="charter_ref_db" info="{&quot;catalog&quot;:&quot;charter_ref_db&quot;,&quot;name&quot;:&quot;viaops_parse_model&quot;,&quot;type&quot;:&quot;VIEW&quot;}">viaops_parse_model</table>
                      <columns>
                        <column>aggr_func</column>
                        <column>parse_source_group</column>
                        <column>parse_source_name</column>
                        <column>parse_target_app</column>
                        <column>parse_target_metric</column>
                      </columns>
                      <growColumns/>
                      <filter>${ref_filterScript}</filter>
                      <incremental>false</incremental>
                    </query>
                    <pollRate every="${poll}/m" value="NaN"/>
                  </Model>
                </Node>
                <Node index="1005_2" uuid="46c6dae7-217b-466f-8a0a-1f3b14d70d9f" type="Window" label="Group Metrics" x="380" y="20" width="130" height="135">
                  <Source name="source" uid="0" outputType="DStream" dataType="class:SystemModelData">
                    <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="e0fdeeb6-a708-4a70-8958-837d58e1e40d">
                      <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_source_group" label="parse_source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_source_name" label="parse_source_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_app" label="parse_target_app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_metric" label="parse_target_metric" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="All" uid="0" outputType="DStream" dataType="class:SystemModelData">
                    <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Output name="Changes" uid="1" outputType="DStream" dataType="class:SystemModelData">
                    <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Output name="Expired" uid="2" outputType="DStream" dataType="class:SystemModelData">
                    <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Output name="Deleted" uid="3" outputType="DStream" dataType="class:SystemModelData">
                    <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model windowPolicy="attribute" partition="" checkpointInterval="/S" restoreState="false">
                    <Time mode="system"/>
                    <GroupKeys policy="latest" numPerGroup="1">
                      <GroupKey field="parse_source_group"/>
                      <GroupKey field="parse_source_name"/>
                      <GroupKey field="parse_target_app"/>
                      <GroupKey field="parse_target_metric"/>
                    </GroupKeys>
                    <Expirations duration="/S" baseline="lastevent"/>
                  </Model>
                </Node>
                <Node index="1005_3" uuid="bc4ea8d5-e474-4b66-8e55-040246f8a424" type="Compute" label="All Metrics" x="553" y="20" width="130" height="75">
                  <Source name="source" uid="0" outputType="DStream" dataType="class:SystemModelData">
                    <DataSource category="#OUTPUT" id="undefined" name="All" nodeId="46c6dae7-217b-466f-8a0a-1f3b14d70d9f">
                      <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_source_group" label="parse_source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_source_name" label="parse_source_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_app" label="parse_target_app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_metric" label="parse_target_metric" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="out" uid="0" outputType="DStream" dataType="(String,String,String,String,String)">
                    <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model isClassRef="false">
                    <Computes>
                      <Compute op="sleText" field="*" arg="" value="aggr_func" outputType="string" alias="aggr_func" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="parse_source_group" outputType="string" alias="parse_source_group" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="parse_source_name" outputType="string" alias="parse_source_name" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="parse_target_app" outputType="string" alias="parse_target_app" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="parse_target_metric" outputType="string" alias="parse_target_metric" wordWarp="true"/>
                    </Computes>
                    <CheckboxStatus isChecked="mixed"/>
                  </Model>
                </Node>
                <Node index="1005_4" uuid="354f4d2b-5f04-462e-84fe-455d4a0e8da3" type="outPort" label="Out" x="720" y="40" width="70" height="40">
                  <Source name="source" uid="0" outputType="DStream" dataType="(String,String,String,String,String)">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="bc4ea8d5-e474-4b66-8e55-040246f8a424">
                      <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_source_group" label="parse_source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_source_name" label="parse_source_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_app" label="parse_target_app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_metric" label="parse_target_metric" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Model>
                    <Properties>
{}
</Properties>
                  </Model>
                </Node>
                <Node index="1005_5" uuid="e0fdeeb6-a708-4a70-8958-837d58e1e40d" type="Adhoc" label="FlatMap" x="210" y="20" width="130" height="75">
                  <Source name="source1" uid="0" outputType="DStream" dataType="class:SystemModelData">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="6029ac79-48d9-4e91-8d5f-bf6b1e7cc197">
                      <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="aggr_func" column="aggr_func"/>
                      <Field name="parse_source_group" label="parse_source_group" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="parse_source_group" column="parse_source_group"/>
                      <Field name="parse_source_name" label="parse_source_name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="parse_source_name" column="parse_source_name"/>
                      <Field name="parse_target_app" label="parse_target_app" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="parse_target_app" column="parse_target_app"/>
                      <Field name="parse_target_metric" label="parse_target_metric" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="parse_target_metric" column="parse_target_metric"/>
                    </DataSource>
                  </Source>
                  <Output name="Out1" uid="0" outputType="DStream" dataType="class:SystemModelData" referenceType="SystemModelData">
                    <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model>
                    <Script><![CDATA[val retval = source1.flatMap { data =>
    data.parse_source_name.split(",").map { source_name =>
        SystemModelData(data.aggr_func, data.parse_source_group, source_name, data.parse_target_app, data.parse_target_metric)
    }
}]]></Script>
                  </Model>
                </Node>
                <Link srcId="bc4ea8d5-e474-4b66-8e55-040246f8a424" srcPort="out:0" tgtId="354f4d2b-5f04-462e-84fe-455d4a0e8da3" tgtPort="in:0"/>
                <Link srcId="46c6dae7-217b-466f-8a0a-1f3b14d70d9f" srcPort="dout:0" tgtId="bc4ea8d5-e474-4b66-8e55-040246f8a424" tgtPort="in:0"/>
                <Link srcId="6029ac79-48d9-4e91-8d5f-bf6b1e7cc197" srcPort="out:0" tgtId="e0fdeeb6-a708-4a70-8958-837d58e1e40d" tgtPort="din:0"/>
                <Link srcId="e0fdeeb6-a708-4a70-8958-837d58e1e40d" srcPort="dout:0" tgtId="46c6dae7-217b-466f-8a0a-1f3b14d70d9f" tgtPort="in:0"/>
                <Codes/>
                <Libraries/>
                <Resources/>
                <Properties>[{&quot;editorType&quot;:&quot;_dataSourceSelector&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;dataSource&quot;,&quot;label&quot;:&quot;Datasource&quot;,&quot;type&quot;:&quot;object&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:{&quot;dataSource&quot;:&quot;/vitria/m3o/datasource/DefaultDomain/charter_ref_db&quot;},&quot;defaultValueForExisted&quot;:{&quot;dataSource&quot;:&quot;/vitria/m3o/datasource/DefaultDomain/charter_ref_db&quot;,&quot;databaseURL&quot;:&quot;jdbc:mysql://10.101.3.186:3306/charter_ref_db&quot;,&quot;userName&quot;:&quot;root&quot;,&quot;password&quot;:&quot;&lt;X0ws2Kuv10c59bxYGyv4xvu&gt;&quot;,&quot;driverType&quot;:&quot;com.mysql.jdbc.Driver&quot;},&quot;constraints&quot;:{&quot;type&quot;:&quot;dataSource&quot;,&quot;args&quot;:{}},&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;common&quot;,&quot;name&quot;:&quot;ref_table&quot;,&quot;label&quot;:&quot;System Model Table&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;viaops_parse_model&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;common&quot;,&quot;name&quot;:&quot;ref_source_group&quot;,&quot;label&quot;:&quot;Source Group&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;stva_video&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;script&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;ref_filterScript&quot;,&quot;label&quot;:&quot;Filter Script&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:true,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;parse_source_group=&apos;${source_group}&apos;&quot;,&quot;constraints&quot;:{&quot;type&quot;:&quot;script&quot;,&quot;args&quot;:{&quot;scriptMode&quot;:&quot;sql&quot;,&quot;scriptSection&quot;:&quot;false&quot;,&quot;header&quot;:&quot;false&quot;}},&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;number&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;common&quot;,&quot;name&quot;:&quot;poll&quot;,&quot;label&quot;:&quot;Poll Rate (Minutes)&quot;,&quot;type&quot;:&quot;integer&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;1&quot;,&quot;defaultValueForExisted&quot;:&quot;1&quot;,&quot;constraints&quot;:{&quot;min&quot;:&quot;0&quot;,&quot;max&quot;:&quot;999999&quot;,&quot;step&quot;:&quot;1&quot;,&quot;places&quot;:&quot;&quot;,&quot;maxLength&quot;:&quot;&quot;},&quot;runtimeControl&quot;:false}]</Properties>
                <Types>[{&quot;name&quot;:&quot;SystemModelData&quot;,&quot;namespace&quot;:&quot;&quot;,&quot;schema&quot;:[{&quot;name&quot;:&quot;aggr_func&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;parse_source_group&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;parse_source_name&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;parse_target_app&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;parse_target_metric&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false}]}]</Types>
              </Flow>
            </__subflow__>
            <__binding__><![CDATA[{"dataSource":"dataSource","ref_table":"ref_table","ref_source_group":"source_group","poll":"poll"}]]></__binding__>
          </Model>
        </Node>
        <Node index="1006" uuid="4a019801-4853-477a-862d-7a888462e914" type="subflow" label="FileSource" x="0" y="40" width="130" height="95">
          <Output name="Out" uid="0" outputType="DStream" dataType="String">
            <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
          </Output>
          <Output name="OutFileName" uid="1" outputType="DStream" dataType="(String,String)">
            <Field name="file" label="file" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="data" label="data" type="string" clazz="" isArray="false" isOptional="false"/>
            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
          </Output>
          <Model>
            <Properties>
{&quot;subFlow&quot;:&quot;remote:///viaops.ingestion/FileSource&quot;,&quot;stopBatchCount&quot;:0,&quot;fsource_source_group&quot;:&quot;&quot;,&quot;fsource&quot;:&quot;&quot;,&quot;vtimezone&quot;:&quot;Etc/GMT&quot;,&quot;url&quot;:&quot;&quot;,&quot;filter&quot;:&quot;.*&quot;,&quot;maxBatchSize&quot;:&quot;0&quot;,&quot;sample&quot;:&quot;\&quot;_time\&quot;,action,helo,host,mc,ph,virus,p,ph,reason,tag,cc,dstmta\n\&quot;1548437402.000\&quot;,queue,\&quot;pgg171.bf07d.hubspotemail.net\&quot;,\&quot;impin018.msg.chrl.nc.charter.net\&quot;,inbound,\&quot;content_postsplit\&quot;,0,,\&quot;content_postsplit\&quot;,normal,,,\n\&quot;1548437402.000\&quot;,queue,\&quot;cloudmail06.ondemand.com\&quot;,\&quot;impin007.msg.chrl.nc.charter.net\&quot;,inbound,\&quot;content_postsplit\&quot;,0,,\&quot;content_postsplit\&quot;,normal,,,&quot;,&quot;enableAudit&quot;:&quot;true&quot;,&quot;auditUrl&quot;:&quot;viaops_ingestion_auditlog&quot;}
</Properties>
            <__subflow__>
              <Flow index="1006" uuid="FileSource" isNested="true" revision="5639" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/FileSource" name="FileSource" showFooter="true">
                <Node index="1006_1" uuid="a30c6cac-828b-4812-86c7-7e31ca6c1b02" type="Adhoc" label="Transform" x="492" y="60" width="130" height="75">
                  <Source name="source1" uid="0" outputType="DStream" dataType="(String,String)">
                    <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="29887fd0-bfb2-40c6-8ee2-485810cd70bc">
                      <Field name="file" label="file" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="Out1" uid="0" outputType="DStream" dataType="String" referenceType="string">
                    <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model>
                    <Script><![CDATA[val retval = source1.map { case (name, data) =>
            data
        }]]></Script>
                  </Model>
                </Node>
                <Node index="1006_2" uuid="0aabd66a-c275-4691-8a6e-153b22beb785" type="outPort" label="Out" x="733" y="80" width="70" height="40">
                  <Source name="source" uid="0" outputType="DStream" dataType="String">
                    <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="a30c6cac-828b-4812-86c7-7e31ca6c1b02">
                      <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Model>
                    <Properties>
{}
</Properties>
                  </Model>
                </Node>
                <Node index="1006_3" uuid="9557aa47-7ea3-4193-8cfa-97199d1e4c82" type="Compute" label="Normalize" x="700" y="160" width="130" height="75">
                  <Source name="source" uid="0" outputType="DStream" dataType="class:Metric">
                    <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="2b85201b-32aa-4fed-87e6-bf67fe4c54c9">
                      <Field name="metricName" label="metricName" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metricValue" label="metricValue" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metricUom" label="metricUom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uomLabel" label="uomLabel" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                    <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                    <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
                    <Computes>
                      <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${vtimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time()) / 1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="metricName" outputType="string" alias="metric_name" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="metricValue" outputType="string" alias="metric_value" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="metricUom" outputType="string" alias="metric_uom" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="uomLabel" outputType="string" alias="uom_label" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;${fsource_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now()) / 1000" outputType="long" alias="system_tm" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="if(${stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;${vtimezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;${fsource_source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
                    </Computes>
                    <CheckboxStatus isChecked="false"/>
                  </Model>
                </Node>
                <Node index="1006_4" uuid="2b85201b-32aa-4fed-87e6-bf67fe4c54c9" type="Adhoc" label="Metrics" x="490" y="160" width="130" height="75">
                  <Source name="source1" uid="0" outputType="DStream" dataType="(String,String)" referenceType="FileInfo">
                    <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="29887fd0-bfb2-40c6-8ee2-485810cd70bc">
                      <Field name="file" label="file" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="Out1" uid="0" outputType="DStream" dataType="class:Metric" referenceType="Metric">
                    <Field name="metricName" label="metricName" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metricValue" label="metricValue" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metricUom" label="metricUom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="uomLabel" label="uomLabel" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model>
                    <Script><![CDATA[import scala.collection.immutable.HashSet
                val retval = source1.transform { rdd =>
                    val seq = if (${enableAudit}) {
                        val (set, cnt) = rdd.map { case(name, data) =>
                            (HashSet(name), 1L)
                        }.fold((HashSet(), 0L)) { (a, b) =>
                            (a._1 ++ b._1, a._2 + b._2)
                        }
                        val files = set.mkString(",")
                        if(cnt > 0) {
                            Seq(
                                Metric("Total Input Lines", cnt.toString, "sum", "Count"),
                                Metric("Files", files, "list", "List")
                            )
                        } else {
                            Seq()
                        }
                    } else {
                        Seq()
                    }
                    rdd.sparkContext.parallelize(seq, 1)
                }            ]]></Script>
                  </Model>
                </Node>
                <Node index="1006_5" uuid="29887fd0-bfb2-40c6-8ee2-485810cd70bc" type="Adhoc" label="File Source" x="220" y="60" width="130" height="75">
                  <Source name="source1" uid="0" outputType="DStream" dataType="String">
                    <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="67d00967-c0b2-4b14-8721-9f003aee65ba">
                      <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="Out1" uid="0" outputType="DStream" dataType="(String,String)" referenceType="FileInfo">
                    <Field name="file" label="file" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="data" label="data" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model>
                    <Script><![CDATA[import org.apache.spark.streaming.dstream.FileSourceSettings
import org.apache.hadoop.fs.Path
import org.apache.hadoop.fs.FileStatus

val settings = new FileSourceSettings
val maxBatchSize =  ${maxBatchSize} * 1024L * 1024

settings.setMaxTotalFileSizePerBatch(maxBatchSize)
settings.setAlwaysStartedFromSpecifiedPosition(false)
settings.setInitialOffset("time")
val sdf = new java.text.SimpleDateFormat("yyyy-MM-dd")

val startTime = if ("${startDate}" == "" || "${startDate}".contains("startDate")) {
    System.currentTimeMillis
} else if("${startDate}".contains("now")) {
    System.currentTimeMillis
} else {
    sdf.parse("${startDate}").getTime
}
settings.setStartTime(startTime)
val endTime = if ("${endDate}" == "" || "${endDate}".contains("endDate")) {
    -1L
} else if("${endDate}".contains("now")) {
    System.currentTimeMillis
} else {
    sdf.parse("${endDate}").getTime
}
settings.setEndTime(endTime)
val urls = "${url}".split(",").toSeq
val retval = TextStreamBuild.textFileStream(ssc, urls,"${filter}", settings, null, enrichFunc = Option((st : Map[String, FileStatus], filename : String) => filename)).filter(line => !line._2.isEmpty())]]></Script>
                    <shellScript><![CDATA[{"global":"","custom_func":"    import com.vitria.spark.streaming.api.scala.source.SourceUtil._\n    import com.vitria.spark.streaming.api.scala.source.NameFilter\n    import org.apache.spark.sql.functions.input_file_name\n    import org.apache.hadoop.fs.{FileSystem, Path}\n    \n    val endMarkerToken__4001: String = \"_VTEND_\"\n    val endMakerRDD__4001 = sc.makeRDD(Array((endMarkerToken__4001, endMarkerToken__4001)), 1)\n    //val accum = sc.accumulator(0, \"End Accumulator\")\n    def _endMarkerFilter__4001(source1: DStream[(String, String)]): DStream[(String, String)] = {\n        val retval = source1.filter { case(file, data) => \n            data.contains(\"_VTEND_\") == false\n        }\n        retval\n    }\n    // Simulate Stream... use full package name for Queue to avoid potential conflict with java.util.Queue\n    var data: Array[String] = Array[String]()\n    var rs: Array[(String, String)] = Array[(String, String)]()\n    var rdd: RDD[(String, String)] = null\n    \n    val urls = \"${url}\".split(\",\")\n    val startDate = \"${startDate}\"\n    val endDate = \"${endDate}\"\n    val filter = \"${filter}\"\n    \n    val sdf = new java.text.SimpleDateFormat(\"yyyy-MM-dd\")\n    \n    val startTime = if (\"${startDate}\" == \"\" || \"${startDate}\".contains(\"startDate\")) {\n        0L\n    } else if(\"${startDate}\".contains(\"now\")) {\n        System.currentTimeMillis\n    } else {\n        sdf.parse(\"${startDate}\").getTime\n    }\n    val endTime = if (\"${endDate}\" == \"\" || \"${endDate}\".contains(\"endDate\")) {\n        -1L\n    } else if(\"${endDate}\".contains(\"now\")) {\n        System.currentTimeMillis\n    } else {\n        sdf.parse(\"${endDate}\").getTime\n    }    \n    \n    val filePattern = filter.r\n    val limit = 1024L * 1024 * 2\n    var size = 0L    \n    rdd = sc.union(urls.map(new Path(_)).flatMap { url =>\n      FileSystem.get(url.toUri, sc.hadoopConfiguration).listStatus(url).filter { status =>\n        if (status.isDirectory)\n          false\n        else if (status.getModificationTime < startTime)\n          false\n        else if (status.getModificationTime > endTime && endTime > 0)\n          false\n        else {\n          val name = status.getPath.getName\n          if (name.startsWith(\".\") || name.startsWith(\"_\"))\n            false\n          else if (filePattern.findFirstIn(name) == None)\n            false\n          else\n            true\n        }\n      }\n    }.sortBy(_.getModificationTime).filter { status =>\n      val before = size\n      size += status.getLen\n      before == 0 || size < limit\n    }.map { status =>\n      val path = status.getPath.toString\n      sc.textFile(path).filter(!_.isEmpty).map((path, _))\n    })\n    rs = rdd.take(10)\n    data = rs.map {case(file, data) => \n        data\n    }\n    if (data.length == 0) {\n        data = \"${sample}\".split(\"\\\\n\").map(_.trim)\n    }\n    \n    if (rs.length == 0) {\n      rs = data.map { x => {\n        val line = x.trim()\n        if (!line.startsWith(\"(\")) {\n          (\"N/A\", x)\n        } else {\n          val tmp = line.substring(line.indexOf(\"(\") + 1, line.indexOf(\")\"))\n          (tmp.substring(0, tmp.indexOf(\",\")), tmp.substring(tmp.indexOf(\",\") + 1))\n        }\n      }\n      }\n    }\n\n    val queue = scala.collection.mutable.Queue(sc.parallelize(rs))\n\n    val textSource = QueueStreamBuild.queueStream(ssc, queue, true, endMakerRDD__4001)\n    textSource.foreachRDD(rdd => {\n      rdd.foreach{ case(file, data) =>\n        if (data == \"_VTEND_\") {\n          accum += 1\n        }\n      }\n    })\n    val retval = _endMarkerFilter__4001(textSource)    "}]]></shellScript>
                  </Model>
                </Node>
                <Node index="1006_6" uuid="e2b231bc-52ff-4d33-8235-8424774dfd0f" type="subflow" label="FileAuditLog" x="920" y="160" width="130" height="75">
                  <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="9557aa47-7ea3-4193-8cfa-97199d1e4c82">
                      <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                    <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                    <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model>
                    <Properties>
{&quot;subFlow&quot;:&quot;remote:///viaops.ingestion/AuditLog&quot;,&quot;audit_parquetfolder&quot;:&quot;${auditUrl}&quot;,&quot;source&quot;:&quot;${fsource}&quot;}
</Properties>
                    <__subflow__>
                      <Flow index="1006_6" uuid="AuditLog" isNested="true" revision="800" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/AuditLog" name="AuditLog" showFooter="true">
                        <Node index="1006_6_1" uuid="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" type="inPort" label="In" x="20" y="34" width="70" height="40">
                          <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog" referenceType="viaops.ingestion.AuditLog">
                            <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                            <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                          </Output>
                          <Model>
                            <Properties>
{&quot;portType&quot;:&quot;DStream&quot;,&quot;type&quot;:{&quot;name&quot;:&quot;viaops.ingestion.AuditLog&quot;,&quot;kind&quot;:&quot;caseclass&quot;}}
</Properties>
                          </Model>
                        </Node>
                        <Node index="1006_6_2" uuid="2a748b73-8ff7-4d04-8666-9123dfba32f3" type="outPort" label="Out" x="440" y="34" width="70" height="40">
                          <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                            <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                              <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                            </DataSource>
                          </Source>
                          <Model>
                            <Properties>
{&quot;type&quot;:{&quot;name&quot;:&quot;viaops.ingestion.AuditLog&quot;,&quot;kind&quot;:&quot;caseclass&quot;}}
</Properties>
                          </Model>
                        </Node>
                        <Node index="1006_6_3" uuid="322e4e59-dd18-4247-8532-ecf44de32e0b" type="Compute" label="Normalize" x="140" y="110" width="130" height="75">
                          <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                            <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                              <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                            </DataSource>
                          </Source>
                          <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                            <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                            <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                          </Output>
                          <Model _caseClass="AuditLogTable" isClassRef="true">
                            <Computes>
                              <Compute op="sleText" field="*" arg="" value="date_key" outputType="long" alias="date_key" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="aggr_start_tm" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="aggr_end_tm" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="metric_name" outputType="string" alias="metric_name" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="metric_value" outputType="string" alias="metric_value" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="metric_uom" outputType="string" alias="metric_uom" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="uom_label" outputType="string" alias="uom_label" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="source_group" outputType="string" alias="source_group" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="system_tm" outputType="long" alias="system_tm" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="process_type" outputType="string" alias="process_type" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="aggr_type" outputType="string" alias="aggr_type" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="source_fmt" outputType="string" alias="source_fmt" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="source_tz" outputType="string" alias="source_tz" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="&quot;${source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="ts_key" outputType="string" alias="ts_key" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="ts_value" outputType="string" alias="ts_value" wordWarp="true"/>
                            </Computes>
                            <CheckboxStatus isChecked="false"/>
                          </Model>
                        </Node>
                        <Node index="1006_6_4" uuid="15ea36d5-561f-4969-8443-62afe82d4154" type="StreamTarget" label="Step 1" x="340" y="110" width="130" height="75">
                          <Source name="source" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                            <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="322e4e59-dd18-4247-8532-ecf44de32e0b">
                              <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                            </DataSource>
                          </Source>
                          <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                            <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                            <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                          </Output>
                          <Model type="hiveTable" tableName="${audit_parquetfolder}" partitionType="eventField" partitionSize="" partitionColumn="date_key,source_group" partitionIndex="0,7" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
                            <__binding__><![CDATA[{"snapshotTableName":""}]]></__binding__>
                          </Model>
                        </Node>
                        <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="322e4e59-dd18-4247-8532-ecf44de32e0b" tgtPort="in:0"/>
                        <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="2a748b73-8ff7-4d04-8666-9123dfba32f3" tgtPort="in:0"/>
                        <Link srcId="322e4e59-dd18-4247-8532-ecf44de32e0b" srcPort="out:0" tgtId="15ea36d5-561f-4969-8443-62afe82d4154" tgtPort="in:0"/>
                        <Codes/>
                        <Libraries/>
                        <Resources/>
                        <Properties>[{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;common&quot;,&quot;name&quot;:&quot;audit_parquetfolder&quot;,&quot;label&quot;:&quot;Audit Log Table&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;${auditUrl}&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;common&quot;,&quot;name&quot;:&quot;source&quot;,&quot;label&quot;:&quot;Source Group Prefix&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;${fsource}&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false}]</Properties>
                        <Types>[{&quot;name&quot;:&quot;AuditLogTable&quot;,&quot;schema&quot;:[{&quot;name&quot;:&quot;date_key&quot;,&quot;type&quot;:&quot;long&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;aggr_start_tm&quot;,&quot;type&quot;:&quot;long&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;aggr_end_tm&quot;,&quot;type&quot;:&quot;long&quot;,&quot;_isOptional&quot;:true,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;metric_name&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;metric_value&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;metric_uom&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;uom_label&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;source_group&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;system_tm&quot;,&quot;type&quot;:&quot;long&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;process_type&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;aggr_type&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;source_fmt&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;source_tz&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;source_group_prefix&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;ts_key&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;ts_value&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false}]}]</Types>
                      </Flow>
                    </__subflow__>
                    <__binding__><![CDATA[{"source":""}]]></__binding__>
                  </Model>
                </Node>
                <Node index="1006_7" uuid="67d00967-c0b2-4b14-8721-9f003aee65ba" type="Adhoc" label="Auto Stop" x="31" y="60" width="130" height="75">
                  <Output name="Out1" uid="0" outputType="DStream" dataType="String" referenceType="string">
                    <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model>
                    <Script><![CDATA[var cnt = 0
        val total = ${stopBatchCount}
        val dummy = new org.apache.spark.streaming.dstream.VTDummyDStream(ssc)
        dummy.foreachRDD{(rdd, time) => 
            if (total > 0 && cnt >= total) {
                logger.warn("Stopping ADF model call started")
                com.vitria.spark.api.scala.SparkAppExceptionHanlders.stopProject()
                logger.warn("Stopping ADF model call finished")
            } else {
                cnt = cnt + 1
            }
        }
        val retval: DStream[String] = null]]></Script>
                    <shellScript><![CDATA[{"custom_func":"    val retval = ssc.queueStream(scala.collection.mutable.Queue(sc.emptyRDD[String]))"}]]></shellScript>
                  </Model>
                </Node>
                <Node index="1006_8" uuid="3851fd83-fa56-4af0-8dfe-d49fbd53f395" type="outPort" label="OutFileName" x="732" y="20" width="100.6875" height="40">
                  <Source name="source" uid="0" outputType="DStream" dataType="(String,String)">
                    <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="29887fd0-bfb2-40c6-8ee2-485810cd70bc">
                      <Field name="file" label="file" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Model>
                    <Properties>
{}
</Properties>
                  </Model>
                </Node>
                <Link srcId="29887fd0-bfb2-40c6-8ee2-485810cd70bc" srcPort="dout:0" tgtId="2b85201b-32aa-4fed-87e6-bf67fe4c54c9" tgtPort="din:0"/>
                <Link srcId="67d00967-c0b2-4b14-8721-9f003aee65ba" srcPort="dout:0" tgtId="29887fd0-bfb2-40c6-8ee2-485810cd70bc" tgtPort="din:0"/>
                <Link srcId="29887fd0-bfb2-40c6-8ee2-485810cd70bc" srcPort="dout:0" tgtId="3851fd83-fa56-4af0-8dfe-d49fbd53f395" tgtPort="in:0"/>
                <Link srcId="9557aa47-7ea3-4193-8cfa-97199d1e4c82" srcPort="out:0" tgtId="e2b231bc-52ff-4d33-8235-8424774dfd0f" tgtPort="din:0"/>
                <Link srcId="2b85201b-32aa-4fed-87e6-bf67fe4c54c9" srcPort="dout:0" tgtId="9557aa47-7ea3-4193-8cfa-97199d1e4c82" tgtPort="in:0"/>
                <Link srcId="a30c6cac-828b-4812-86c7-7e31ca6c1b02" srcPort="dout:0" tgtId="0aabd66a-c275-4691-8a6e-153b22beb785" tgtPort="in:0"/>
                <Link srcId="29887fd0-bfb2-40c6-8ee2-485810cd70bc" srcPort="dout:0" tgtId="a30c6cac-828b-4812-86c7-7e31ca6c1b02" tgtPort="din:0"/>
                <Codes/>
                <Libraries>
                  <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/bin/client/jboss-client.jar"/>
                  <Lib scope="system" systemPath="${VTBA_HOME}/spark/library/vitria-spark-library.jar"/>
                  <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/modules/com/vitria/vtlibs/main/vtclient.jar"/>
                  <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/modules/com/vitria/vtlibs/main/vtfc.jar"/>
                  <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/modules/com/vitria/vtlibs/main/vtclusterservice.jar"/>
                  <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/modules/system/layers/base/org/hornetq/main/hornetq-core-client-2.4.7.Final.jar"/>
                  <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/modules/system/layers/base/org/hornetq/main/hornetq-jms-client-2.4.7.Final.jar"/>
                  <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/modules/system/layers/base/org/hornetq/main/hornetq-commons-2.4.7.Final.jar"/>
                  <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/modules/com/vitria/thirdparty/xmlbeans/main/xmlbeans-2.3.0.jar"/>
                </Libraries>
                <Resources/>
                <Properties>[{&quot;editorType&quot;:&quot;number&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;stopBatchCount&quot;,&quot;label&quot;:&quot;Stop After n Microbatch&quot;,&quot;type&quot;:&quot;integer&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:0,&quot;constraints&quot;:{&quot;min&quot;:&quot;0&quot;,&quot;max&quot;:&quot;999999&quot;,&quot;step&quot;:&quot;1&quot;,&quot;places&quot;:&quot;&quot;,&quot;maxLength&quot;:&quot;&quot;},&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;fsource_source_group&quot;,&quot;label&quot;:&quot;Source Group&quot;,&quot;desc&quot;:&quot;Source Group of Metrics&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;fsource&quot;,&quot;label&quot;:&quot;Source Group Prefix&quot;,&quot;desc&quot;:&quot;The source name&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;vtimezone&quot;,&quot;label&quot;:&quot;Time Zone&quot;,&quot;desc&quot;:&quot;The timezone to calculate date&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;Etc/GMT&quot;,&quot;defaultValueForExisted&quot;:&quot;Europe/London&quot;,&quot;enumSource&quot;:&quot;rest:/global/?op=get.timezones&quot;,&quot;runtimeControl&quot;:false},{&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group&quot;,&quot;groupLabel&quot;:&quot;Source&quot;,&quot;name&quot;:&quot;url&quot;,&quot;label&quot;:&quot;File URL&quot;,&quot;desc&quot;:&quot;The File URL to monitor. It can be directories list delimited by comma&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group&quot;,&quot;groupLabel&quot;:&quot;Source&quot;,&quot;name&quot;:&quot;filter&quot;,&quot;label&quot;:&quot;File Filter&quot;,&quot;desc&quot;:&quot;The file filter regular expression&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;.*&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group&quot;,&quot;groupLabel&quot;:&quot;Source&quot;,&quot;name&quot;:&quot;maxBatchSize&quot;,&quot;label&quot;:&quot;Max Batch Size (MB)&quot;,&quot;desc&quot;:&quot;The max file size which will be processed in one batch&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:true,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;0&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;date&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group&quot;,&quot;groupLabel&quot;:&quot;Source&quot;,&quot;name&quot;:&quot;startDate&quot;,&quot;label&quot;:&quot;Start Date&quot;,&quot;desc&quot;:&quot;The start date constraint and empty means starting from oldest&quot;,&quot;type&quot;:&quot;date&quot;,&quot;optional&quot;:true,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;constraints&quot;:{&quot;itemStyle&quot;:&quot;width: 200px;&quot;,&quot;supportNow&quot;:true,&quot;supportClear&quot;:&quot;true&quot;},&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;date&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group&quot;,&quot;groupLabel&quot;:&quot;Source&quot;,&quot;name&quot;:&quot;endDate&quot;,&quot;label&quot;:&quot;End Date&quot;,&quot;desc&quot;:&quot;End date constraint and empty means always process to latest time&quot;,&quot;type&quot;:&quot;date&quot;,&quot;optional&quot;:true,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;constraints&quot;:{&quot;itemStyle&quot;:&quot;width: 200px;&quot;,&quot;supportNow&quot;:true,&quot;supportClear&quot;:&quot;true&quot;},&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;sourceSample&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;sample&quot;,&quot;label&quot;:&quot;Sample Data&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:true,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;constraints&quot;:{&quot;type&quot;:&quot;sourceSample&quot;,&quot;args&quot;:{&quot;rows&quot;:&quot;4&quot;,&quot;itemStyle&quot;:&quot;height: auto;width: calc(100% - 54px);&quot;},&quot;impactSchema&quot;:true},&quot;excluded&quot;:true,&quot;runtimeControl&quot;:false,&quot;group&quot;:&quot;group&quot;,&quot;groupLabel&quot;:&quot;Source&quot;},{&quot;editorType&quot;:&quot;boolean&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group1&quot;,&quot;groupLabel&quot;:&quot;Audit&quot;,&quot;name&quot;:&quot;enableAudit&quot;,&quot;label&quot;:&quot;Audit Log&quot;,&quot;desc&quot;:&quot;A flag to control whether enable audit log&quot;,&quot;type&quot;:&quot;boolean&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;true&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group1&quot;,&quot;groupLabel&quot;:&quot;Audit&quot;,&quot;name&quot;:&quot;auditUrl&quot;,&quot;label&quot;:&quot;Audit Log Table&quot;,&quot;desc&quot;:&quot;The audit table name&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:true,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;viaops_ingestion_auditlog&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false}]</Properties>
                <Types>[{&quot;name&quot;:&quot;Metric&quot;,&quot;namespace&quot;:&quot;&quot;,&quot;schema&quot;:[{&quot;name&quot;:&quot;metricName&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;metricValue&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;metricUom&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;uomLabel&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false}]},{&quot;name&quot;:&quot;FileInfo&quot;,&quot;namespace&quot;:&quot;&quot;,&quot;schema&quot;:[{&quot;name&quot;:&quot;file&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;data&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false}]}]</Types>
              </Flow>
            </__subflow__>
            <__binding__><![CDATA[{"stopBatchCount":"stopBatchCount","fsource_source_group":"source_group","fsource":"fsource","vtimezone":"timezone","url":"sourceLocation","filter":"sourceFilter","maxBatchSize":"maxBatchSize","startDate":"startDate","endDate":"endDate","enableAudit":"enableAudit","auditUrl":"auditUrl"}]]></__binding__>
          </Model>
        </Node>
        <Node index="1007" uuid="3b53a717-9dbe-4351-813c-c90f108d2158" type="subflow" label="Aggregate" x="806" y="40" width="160" height="75">
          <Source name="source1" uid="0" outputType="DStream" dataType="class:Step4_Class">
            <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="d3e86d1f-8c60-4618-827e-966bc2afda90">
              <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="dstmta" label="dstmta" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="action" label="action" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_source_group" label="parse_source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_source_name" label="parse_source_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_target_app" label="parse_target_app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_target_metric" label="parse_target_metric" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
            </DataSource>
          </Source>
          <Output name="ToNormalize" uid="0" outputType="DStream" dataType="(Long,String,String,String,Long,String,String,String,String,Long,Long)">
            <Field name="_vt_time" label="_vt_time" type="long" isArray="false" isOptional="false"/>
            <Field name="reason" label="reason" type="string" isArray="false" isOptional="false"/>
            <Field name="dstmta" label="dstmta" type="string" isArray="false" isOptional="false"/>
            <Field name="host" label="host" type="string" isArray="false" isOptional="false"/>
            <Field name="datekey" label="datekey" type="long" isArray="false" isOptional="false"/>
            <Field name="aggr_func" label="aggr_func" type="string" isArray="false" isOptional="false"/>
            <Field name="parse_source_group" label="parse_source_group" type="string" isArray="false" isOptional="false"/>
            <Field name="parse_target_app" label="parse_target_app" type="string" isArray="false" isOptional="false"/>
            <Field name="parse_target_metric" label="parse_target_metric" type="string" isArray="false" isOptional="false"/>
            <Field name="count" label="count" type="long" isArray="false" isOptional="false"/>
            <Field name="window_start_time" label="window_start_time" type="long" isArray="false" isOptional="false"/>
            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
          </Output>
          <Model>
            <Properties>
{&quot;subFlow&quot;:&quot;remote:///viaops.ingestion/Aggregate&quot;,&quot;agg_stopBatchCount&quot;:0,&quot;atimezone&quot;:&quot;Etc/GMT&quot;,&quot;agg_source_group&quot;:&quot;&quot;,&quot;agg_source&quot;:&quot;&quot;,&quot;timeSetting&quot;:{&quot;timeSettingValue&quot;:{&quot;timeType&quot;:&quot;event&quot;,&quot;eventField&quot;:&quot;ts&quot;,&quot;hbChecked&quot;:false,&quot;oooChecked&quot;:false,&quot;hbDelay&quot;:&quot;30/S&quot;,&quot;oooDelay&quot;:&quot;30/S&quot;}},&quot;windowSetting&quot;:{&quot;windowSize&quot;:&quot;5/N&quot;,&quot;windowInterval&quot;:&quot;5/N&quot;,&quot;windowPolicy&quot;:&quot;time&quot;},&quot;dimensions&quot;:[&quot;reason&quot;,&quot;dstmta&quot;,&quot;host&quot;,&quot;datekey&quot;,&quot;aggr_func&quot;,&quot;parse_source_group&quot;,&quot;parse_target_app&quot;,&quot;parse_target_metric&quot;],&quot;measures&quot;:[{&quot;type&quot;:&quot;count&quot;,&quot;field&quot;:&quot;&quot;,&quot;asName&quot;:&quot;count&quot;},{&quot;field&quot;:&quot;&quot;,&quot;type&quot;:&quot;window_start_time&quot;,&quot;asName&quot;:&quot;window_start_time&quot;}],&quot;agg_audit_table_folder&quot;:&quot;&quot;,&quot;agg_doaudit&quot;:&quot;true&quot;,&quot;agg_dropped_events&quot;:&quot;&quot;}
</Properties>
            <__subflow__>
              <Flow index="1007" uuid="Aggregate" isNested="true" revision="1810" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/Aggregate" name="Aggregate" showFooter="true">
                <Node index="1007_1" uuid="e83941c2-c6d7-4806-8336-691f792d1fde" type="inPort" label="source1" x="100" y="70" width="72.703125" height="40">
                  <Output name="out" uid="0" outputType="DStream" dataType="class:Step4_Class">
                    <Field name="reason" label="reason" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts" label="ts" type="datetime" clazz="" isArray="false" isOptional="false"/>
                    <Field name="dstmta" label="dstmta" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="host" label="host" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="action" label="action" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="datekey" label="datekey" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model>
                    <Properties>
{&quot;portType&quot;:&quot;*&quot;}
</Properties>
                  </Model>
                </Node>
                <Node index="1007_2" uuid="6783797e-0f4f-49c2-81b7-50906d504046" type="Aggregate" label="Count 5 minutes" x="232" y="50" width="130" height="95">
                  <Source name="source" uid="0" outputType="DStream" dataType="class:Step4_Class">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="e83941c2-c6d7-4806-8336-691f792d1fde">
                      <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dstmta" label="dstmta" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="action" label="action" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_source_group" label="parse_source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_source_name" label="parse_source_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_app" label="parse_target_app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_metric" label="parse_target_metric" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="Out" uid="0" outputType="DStream" dataType="(Long,String,String,String,Long,String,String,String,String,Long,Long)">
                    <Field name="_vt_time" label="_vt_time" type="long" isArray="false" isOptional="false"/>
                    <Field name="reason" label="reason" type="string" isArray="false" isOptional="false"/>
                    <Field name="dstmta" label="dstmta" type="string" isArray="false" isOptional="false"/>
                    <Field name="host" label="host" type="string" isArray="false" isOptional="false"/>
                    <Field name="datekey" label="datekey" type="long" isArray="false" isOptional="false"/>
                    <Field name="aggr_func" label="aggr_func" type="string" isArray="false" isOptional="false"/>
                    <Field name="parse_source_group" label="parse_source_group" type="string" isArray="false" isOptional="false"/>
                    <Field name="parse_target_app" label="parse_target_app" type="string" isArray="false" isOptional="false"/>
                    <Field name="parse_target_metric" label="parse_target_metric" type="string" isArray="false" isOptional="false"/>
                    <Field name="count" label="count" type="long" isArray="false" isOptional="false"/>
                    <Field name="window_start_time" label="window_start_time" type="long" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Output name="Dropped" uid="1" outputType="DStream" dataType="class:Step4_Class">
                    <Field name="reason" label="reason" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts" label="ts" type="datetime" clazz="" isArray="false" isOptional="false"/>
                    <Field name="dstmta" label="dstmta" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="host" label="host" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="action" label="action" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="datekey" label="datekey" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model _caseClass="" isClassRef="false">
                    <Dimensions>
                      <Dimension field="reason"/>
                      <Dimension field="dstmta"/>
                      <Dimension field="host"/>
                      <Dimension field="datekey"/>
                      <Dimension field="aggr_func"/>
                      <Dimension field="parse_source_group"/>
                      <Dimension field="parse_target_app"/>
                      <Dimension field="parse_target_metric"/>
                    </Dimensions>
                    <Measures>
                      <Measure type="count" field="" asName="count"/>
                      <Measure type="window_start_time" field="" asName="window_start_time"/>
                    </Measures>
                    <Window enable="true" size="5/N" step="5/N" timeMode="event" outputCondition="changes">
                      <EventTime field="ts"/>
                    </Window>
                    <__binding__><![CDATA[{"windowSetting":"windowSetting","timeSetting":"timeSetting","dimensions":"dimensions","measures":"measures"}]]></__binding__>
                    <__binding__><![CDATA[{"windowSetting":"windowSetting","timeSetting":"timeSetting","dimensions":"dimensions","measures":"measures"}]]></__binding__>
                  </Model>
                </Node>
                <Node index="1007_3" uuid="328fbd82-fdae-41c6-8c16-c241c5f6da38" type="Aggregate" label="Count Dropped Events" x="426" y="140" width="130" height="75">
                  <Source name="source" uid="0" outputType="DStream" dataType="class:Step4_Class">
                    <DataSource category="#OUTPUT" id="undefined" name="Dropped" nodeId="6783797e-0f4f-49c2-81b7-50906d504046">
                      <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dstmta" label="dstmta" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="action" label="action" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_source_group" label="parse_source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_source_name" label="parse_source_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_app" label="parse_target_app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_metric" label="parse_target_metric" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="out" uid="0" outputType="DStream" dataType="(Long,Long)">
                    <Field name="count" label="count" type="long" isArray="false" isOptional="false"/>
                    <Field name="micro_batch_time" label="micro_batch_time" type="long" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model _caseClass="" isClassRef="false">
                    <Measures>
                      <Measure type="count" field="" asName="count"/>
                      <Measure type="micro_batch_time" field="" asName="micro_batch_time"/>
                    </Measures>
                    <Window enable="false"/>
                  </Model>
                </Node>
                <Node index="1007_4" uuid="77779a47-2c4b-4aed-8f85-cf080f562555" type="Aggregate" label="Get earliest event time" x="427" y="229" width="130" height="75">
                  <Source name="source" uid="0" outputType="DStream" dataType="class:Step4_Class">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="e83941c2-c6d7-4806-8336-691f792d1fde">
                      <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dstmta" label="dstmta" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="action" label="action" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_source_group" label="parse_source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_source_name" label="parse_source_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_app" label="parse_target_app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_metric" label="parse_target_metric" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="out" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
                    <Field name="min_ts" label="min_ts" type="datetime" isArray="false" isOptional="true"/>
                    <Field name="micro_batch_time" label="micro_batch_time" type="long" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model _caseClass="" isClassRef="false">
                    <Measures>
                      <Measure type="min" field="ts" asName="min_ts"/>
                      <Measure type="micro_batch_time" field="" asName="micro_batch_time"/>
                    </Measures>
                    <Window enable="false"/>
                    <__binding__><![CDATA[{"measures":""}]]></__binding__>
                    <__binding__><![CDATA[{"measures":""}]]></__binding__>
                  </Model>
                </Node>
                <Node index="1007_5" uuid="2348b56b-9a33-4b0e-8a3e-1f8460ca4a4c" type="outPort" label="ToNormalize" x="472" y="40" width="96.6875" height="40">
                  <Source name="source" uid="0" outputType="DStream" dataType="(Long,String,String,String,Long,String,String,String,String,Long,Long)">
                    <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="6783797e-0f4f-49c2-81b7-50906d504046">
                      <Field name="_vt_time" label="_vt_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      <Field name="dstmta" label="dstmta" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      <Field name="parse_source_group" label="parse_source_group" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      <Field name="parse_target_app" label="parse_target_app" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      <Field name="parse_target_metric" label="parse_target_metric" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      <Field name="count" label="count" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      <Field name="window_start_time" label="window_start_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Model>
                    <Properties>
{}
</Properties>
                  </Model>
                </Node>
                <Node index="1007_6" uuid="6d89e7d0-9df0-4c7f-8f9a-4a61a4dc2072" type="Aggregate" label="Get latest event time" x="427" y="308" width="130" height="75">
                  <Source name="source" uid="0" outputType="DStream" dataType="class:Step4_Class">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="e83941c2-c6d7-4806-8336-691f792d1fde">
                      <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dstmta" label="dstmta" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="action" label="action" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_source_group" label="parse_source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_source_name" label="parse_source_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_app" label="parse_target_app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_metric" label="parse_target_metric" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="out" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
                    <Field name="max_ts" label="max_ts" type="datetime" isArray="false" isOptional="true"/>
                    <Field name="micro_batch_time" label="micro_batch_time" type="long" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model _caseClass="" isClassRef="false">
                    <Measures>
                      <Measure type="max" field="ts" asName="max_ts"/>
                      <Measure type="micro_batch_time" field="" asName="micro_batch_time"/>
                    </Measures>
                    <Window enable="false"/>
                    <__binding__><![CDATA[{"measures":""}]]></__binding__>
                    <__binding__><![CDATA[{"measures":""}]]></__binding__>
                  </Model>
                </Node>
                <Node index="1007_7" uuid="4efed069-fbe4-42b4-84f5-418fa5488257" type="Compute" label="Conver to metrics (Dropped Events)" x="609" y="140" width="130" height="75">
                  <Source name="source" uid="0" outputType="DStream" dataType="(Long,Long)">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="328fbd82-fdae-41c6-8c16-c241c5f6da38">
                      <Field name="count" label="count" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      <Field name="micro_batch_time" label="micro_batch_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                    <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                    <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
                    <Computes>
                      <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${atimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;Total Dropped Events&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="cast(count, &quot;string&quot;)" outputType="string" alias="metric_value" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;sum&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;Count&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;${agg_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="if(${agg_stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;${atimezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;${agg_source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
                    </Computes>
                    <CheckboxStatus isChecked="false"/>
                  </Model>
                </Node>
                <Node index="1007_8" uuid="60d1ab54-b1e5-466d-886a-d566772cdc1b" type="subflow" label="CharterTemplateAuditlog" x="1012" y="194" width="130" height="75">
                  <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9">
                      <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                    <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                    <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model>
                    <Properties>
{&quot;subFlow&quot;:&quot;remote:///viaops.ingestion/AuditLog&quot;,&quot;audit_parquetfolder&quot;:&quot;${agg_audit_table_folder}&quot;,&quot;source&quot;:&quot;${agg_source}&quot;}
</Properties>
                    <__subflow__>
                      <Flow index="1007_8" uuid="AuditLog" isNested="true" revision="800" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/AuditLog" name="AuditLog" showFooter="true">
                        <Node index="1007_8_1" uuid="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" type="inPort" label="In" x="20" y="34" width="70" height="40">
                          <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog" referenceType="viaops.ingestion.AuditLog">
                            <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                            <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                          </Output>
                          <Model>
                            <Properties>
{&quot;portType&quot;:&quot;DStream&quot;,&quot;type&quot;:{&quot;name&quot;:&quot;viaops.ingestion.AuditLog&quot;,&quot;kind&quot;:&quot;caseclass&quot;}}
</Properties>
                          </Model>
                        </Node>
                        <Node index="1007_8_2" uuid="2a748b73-8ff7-4d04-8666-9123dfba32f3" type="outPort" label="Out" x="440" y="34" width="70" height="40">
                          <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                            <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                              <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                            </DataSource>
                          </Source>
                          <Model>
                            <Properties>
{&quot;type&quot;:{&quot;name&quot;:&quot;viaops.ingestion.AuditLog&quot;,&quot;kind&quot;:&quot;caseclass&quot;}}
</Properties>
                          </Model>
                        </Node>
                        <Node index="1007_8_3" uuid="322e4e59-dd18-4247-8532-ecf44de32e0b" type="Compute" label="Normalize" x="140" y="110" width="130" height="75">
                          <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                            <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                              <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                            </DataSource>
                          </Source>
                          <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                            <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                            <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                          </Output>
                          <Model _caseClass="AuditLogTable" isClassRef="true">
                            <Computes>
                              <Compute op="sleText" field="*" arg="" value="date_key" outputType="long" alias="date_key" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="aggr_start_tm" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="aggr_end_tm" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="metric_name" outputType="string" alias="metric_name" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="metric_value" outputType="string" alias="metric_value" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="metric_uom" outputType="string" alias="metric_uom" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="uom_label" outputType="string" alias="uom_label" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="source_group" outputType="string" alias="source_group" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="system_tm" outputType="long" alias="system_tm" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="process_type" outputType="string" alias="process_type" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="aggr_type" outputType="string" alias="aggr_type" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="source_fmt" outputType="string" alias="source_fmt" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="source_tz" outputType="string" alias="source_tz" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="&quot;${source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="ts_key" outputType="string" alias="ts_key" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="ts_value" outputType="string" alias="ts_value" wordWarp="true"/>
                            </Computes>
                            <CheckboxStatus isChecked="false"/>
                          </Model>
                        </Node>
                        <Node index="1007_8_4" uuid="15ea36d5-561f-4969-8443-62afe82d4154" type="StreamTarget" label="Step 1" x="340" y="110" width="130" height="75">
                          <Source name="source" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                            <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="322e4e59-dd18-4247-8532-ecf44de32e0b">
                              <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                            </DataSource>
                          </Source>
                          <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                            <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                            <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                          </Output>
                          <Model type="hiveTable" tableName="${audit_parquetfolder}" partitionType="eventField" partitionSize="" partitionColumn="date_key,source_group" partitionIndex="0,7" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
                            <__binding__><![CDATA[{"snapshotTableName":""}]]></__binding__>
                          </Model>
                        </Node>
                        <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="322e4e59-dd18-4247-8532-ecf44de32e0b" tgtPort="in:0"/>
                        <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="2a748b73-8ff7-4d04-8666-9123dfba32f3" tgtPort="in:0"/>
                        <Link srcId="322e4e59-dd18-4247-8532-ecf44de32e0b" srcPort="out:0" tgtId="15ea36d5-561f-4969-8443-62afe82d4154" tgtPort="in:0"/>
                        <Codes/>
                        <Libraries/>
                        <Resources/>
                        <Properties>[{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;common&quot;,&quot;name&quot;:&quot;audit_parquetfolder&quot;,&quot;label&quot;:&quot;Audit Log Table&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;${agg_audit_table_folder}&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;common&quot;,&quot;name&quot;:&quot;source&quot;,&quot;label&quot;:&quot;Source Group Prefix&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;${agg_source}&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false}]</Properties>
                        <Types>[{&quot;name&quot;:&quot;AuditLogTable&quot;,&quot;schema&quot;:[{&quot;name&quot;:&quot;date_key&quot;,&quot;type&quot;:&quot;long&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;aggr_start_tm&quot;,&quot;type&quot;:&quot;long&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;aggr_end_tm&quot;,&quot;type&quot;:&quot;long&quot;,&quot;_isOptional&quot;:true,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;metric_name&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;metric_value&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;metric_uom&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;uom_label&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;source_group&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;system_tm&quot;,&quot;type&quot;:&quot;long&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;process_type&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;aggr_type&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;source_fmt&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;source_tz&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;source_group_prefix&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;ts_key&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;ts_value&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false}]}]</Types>
                      </Flow>
                    </__subflow__>
                    <__binding__><![CDATA[{"audit_parquetfolder":"","source":""}]]></__binding__>
                  </Model>
                </Node>
                <Node index="1007_9" uuid="c8abb6dc-3518-41c5-88a5-7e016006e3f4" type="Compute" label="Convert to metrics (Earliest Event Time)" x="610" y="229" width="130" height="75">
                  <Source name="source" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="77779a47-2c4b-4aed-8f85-cf080f562555">
                      <Field name="min_ts" label="min_ts" type="datetime" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                      <Field name="micro_batch_time" label="micro_batch_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                    <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                    <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
                    <Computes>
                      <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${atimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;Earliest Event Time&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="to_nonoption(cast(min_ts, &quot;string&quot;), &quot;null&quot;)" outputType="string" alias="metric_value" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;ealiest&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;Earliest&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;${agg_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="if(${agg_stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;${atimezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;${agg_source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
                    </Computes>
                    <CheckboxStatus isChecked="false"/>
                  </Model>
                </Node>
                <Node index="1007_10" uuid="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" type="Filter" label="Do Audit Log" x="820" y="200" width="130" height="75">
                  <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="5f5f2582-13cd-46eb-8b21-b7894c459c28">
                      <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                    <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                    <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model filterModel="form">
                    <Filters>
                      <Filter field="" op="sleText" arg="" value="" sleText="&quot;${agg_doaudit}&quot; = &quot;True&quot; || &quot;${agg_doaudit}&quot; = &quot;true&quot;"/>
                    </Filters>
                  </Model>
                </Node>
                <Node index="1007_11" uuid="62838e97-64f5-4e62-872f-16d5e1dabdc2" type="subflow" label="CharterTemplateDroppedEvents" x="920" y="47" width="130" height="75">
                  <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.ingestion.DroppedEvents">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="04ac791e-25cd-4c05-88e3-f093d50eb330">
                      <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="Out" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                    <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="event" label="event" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model>
                    <Properties>
{&quot;subFlow&quot;:&quot;remote:///viaops.ingestion/DroppedEvents&quot;,&quot;drop_source_group&quot;:&quot;&quot;,&quot;drop_source&quot;:&quot;${agg_source}&quot;,&quot;drop_sparksqltable&quot;:&quot;${agg_dropped_events}&quot;,&quot;vtimezone&quot;:&quot;Europe/London&quot;}
</Properties>
                    <__subflow__>
                      <Flow index="1007_11" uuid="DroppedEvents" isNested="true" revision="672" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/DroppedEvents" name="DroppedEvents" showFooter="true">
                        <Node index="1007_11_1" uuid="cd64c670-6c5f-440e-8b66-441c760166d8" type="inPort" label="In" x="240" y="32" width="70" height="40">
                          <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.DroppedEvents" referenceType="viaops.ingestion.DroppedEvents">
                            <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="data" label="data" type="string" clazz="" isArray="false" isOptional="false"/>
                            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                          </Output>
                          <Model>
                            <Properties>
{&quot;portType&quot;:&quot;DStream&quot;,&quot;type&quot;:{&quot;name&quot;:&quot;viaops.ingestion.DroppedEvents&quot;,&quot;kind&quot;:&quot;caseclass&quot;}}
</Properties>
                          </Model>
                        </Node>
                        <Node index="1007_11_2" uuid="41a6a5ab-b013-4059-854b-b4d7a89ef9a0" type="Compute" label="to Dropped Events" x="366" y="10" width="130" height="75">
                          <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.DroppedEvents">
                            <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="cd64c670-6c5f-440e-8b66-441c760166d8">
                              <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                            </DataSource>
                          </Source>
                          <Output name="out" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                            <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="event" label="event" type="string" clazz="" isArray="false" isOptional="false"/>
                            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                          </Output>
                          <Model _caseClass="toDroppedEvents_Class" isClassRef="false" udfs="generate_datekey">
                            <Computes>
                              <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${vtimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="&quot;${drop_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="&quot;${drop_source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="error" outputType="string" alias="error" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="data" outputType="string" alias="event" wordWarp="true"/>
                            </Computes>
                            <CheckboxStatus isChecked="mixed"/>
                          </Model>
                        </Node>
                        <Node index="1007_11_3" uuid="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3" type="StreamTarget" label="write to Hive" x="560" y="9" width="130" height="75">
                          <Source name="source" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                            <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="41a6a5ab-b013-4059-854b-b4d7a89ef9a0">
                              <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="event" label="event" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                            </DataSource>
                          </Source>
                          <Output name="out" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                            <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="event" label="event" type="string" clazz="" isArray="false" isOptional="false"/>
                            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                          </Output>
                          <Model type="hiveTable" tableName="${drop_sparksqltable}" partitionType="eventField" partitionSize="" partitionColumn="date_key" partitionIndex="0" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume=""/>
                        </Node>
                        <Node index="1007_11_4" uuid="dd779a23-bc63-4200-8e22-05639b978a68" type="outPort" label="Out" x="746" y="29" width="70" height="40">
                          <Source name="source" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                            <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3">
                              <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="event" label="event" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                            </DataSource>
                          </Source>
                          <Model>
                            <Properties>
{&quot;type&quot;:{&quot;name&quot;:&quot;viaops.ingestion.DroppedEvents&quot;,&quot;kind&quot;:&quot;caseclass&quot;}}
</Properties>
                          </Model>
                        </Node>
                        <Link srcId="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3" srcPort="out:0" tgtId="dd779a23-bc63-4200-8e22-05639b978a68" tgtPort="in:0"/>
                        <Link srcId="41a6a5ab-b013-4059-854b-b4d7a89ef9a0" srcPort="out:0" tgtId="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3" tgtPort="in:0"/>
                        <Link srcId="cd64c670-6c5f-440e-8b66-441c760166d8" srcPort="out:0" tgtId="41a6a5ab-b013-4059-854b-b4d7a89ef9a0" tgtPort="in:0"/>
                        <Codes/>
                        <Libraries/>
                        <Resources/>
                        <Properties>[{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;common&quot;,&quot;name&quot;:&quot;drop_source_group&quot;,&quot;label&quot;:&quot;Source Group&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;common&quot;,&quot;name&quot;:&quot;drop_source&quot;,&quot;label&quot;:&quot;Source Group Prefix&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;${agg_source}&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;common&quot;,&quot;name&quot;:&quot;drop_sparksqltable&quot;,&quot;label&quot;:&quot;Dropped Events Table&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;${agg_dropped_events}&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;common&quot;,&quot;name&quot;:&quot;vtimezone&quot;,&quot;label&quot;:&quot;Time Zone&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;Europe/London&quot;,&quot;defaultValueForExisted&quot;:&quot;Europe/London&quot;,&quot;enumSource&quot;:&quot;rest:/global/?op=get.timezones&quot;,&quot;runtimeControl&quot;:false}]</Properties>
                      </Flow>
                    </__subflow__>
                    <__binding__><![CDATA[{"drop_service":"","drop_app":"","drop_sparksqltable":"","drop_source":"","vtimezone":"atimezone","daylight":"","drop_source_group":"agg_source_group"}]]></__binding__>
                  </Model>
                </Node>
                <Node index="1007_12" uuid="5f5f2582-13cd-46eb-8b21-b7894c459c28" type="Compute" label="Conver to metrics (Latest Event Time)" x="610" y="308" width="130" height="75">
                  <Source name="source" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="6d89e7d0-9df0-4c7f-8f9a-4a61a4dc2072">
                      <Field name="max_ts" label="max_ts" type="datetime" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                      <Field name="micro_batch_time" label="micro_batch_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                    <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                    <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
                    <Computes>
                      <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${atimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;Latest Event Time&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="to_nonoption(cast(max_ts, &quot;string&quot;), &quot;null&quot;)" outputType="string" alias="metric_value" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;latest&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;Latest&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;${agg_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="if(${agg_stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;${atimezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;${agg_source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
                    </Computes>
                    <CheckboxStatus isChecked="false"/>
                  </Model>
                </Node>
                <Node index="1007_13" uuid="85e06d15-61e0-444b-8a0a-d90fbc877d83" type="Adhoc" label="to Json String" x="607" y="47" width="130" height="75">
                  <Source name="source1" uid="0" outputType="DStream" dataType="class:Step4_Class">
                    <DataSource category="#OUTPUT" id="undefined" name="Dropped" nodeId="6783797e-0f4f-49c2-81b7-50906d504046">
                      <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dstmta" label="dstmta" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="action" label="action" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_source_group" label="parse_source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_source_name" label="parse_source_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_app" label="parse_target_app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_metric" label="parse_target_metric" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="Out1" uid="0" outputType="DStream" dataType="String" referenceType="string">
                    <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model>
                    <Script><![CDATA[import com.fasterxml.jackson.databind.ObjectMapper
        import com.fasterxml.jackson.module.scala.DefaultScalaModule
        import com.fasterxml.jackson.module.scala.experimental.ScalaObjectMapper
        
        def toJson[T: Manifest](mapper: ScalaObjectMapper, value: T): String = {
            mapper.writerFor[T].writeValueAsString(value)
        }
        
        val retval = source1.mapPartitions { itr => {
                val mapper = new ObjectMapper() with ScalaObjectMapper
                mapper.registerModule(DefaultScalaModule)
                itr.map(data => toJson(mapper, data))
            }
        }
        ]]></Script>
                  </Model>
                </Node>
                <Node index="1007_14" uuid="04ac791e-25cd-4c05-88e3-f093d50eb330" type="Compute" label="Tag Error" x="760" y="47" width="130" height="75">
                  <Source name="source" uid="0" outputType="DStream" dataType="String">
                    <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="85e06d15-61e0-444b-8a0a-d90fbc877d83">
                      <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.DroppedEvents">
                    <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="data" label="data" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model _caseClass="viaops.ingestion.DroppedEvents" isClassRef="true">
                    <Computes>
                      <Compute op="sleText" field="*" arg="" value="&quot;out-of-order&quot;" outputType="string" alias="error" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="data" outputType="string" alias="data" wordWarp="true"/>
                    </Computes>
                    <CheckboxStatus isChecked="false"/>
                  </Model>
                </Node>
                <Link srcId="85e06d15-61e0-444b-8a0a-d90fbc877d83" srcPort="dout:0" tgtId="04ac791e-25cd-4c05-88e3-f093d50eb330" tgtPort="in:0"/>
                <Link srcId="6783797e-0f4f-49c2-81b7-50906d504046" srcPort="dout:1" tgtId="85e06d15-61e0-444b-8a0a-d90fbc877d83" tgtPort="din:0"/>
                <Link srcId="c8abb6dc-3518-41c5-88a5-7e016006e3f4" srcPort="out:0" tgtId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" tgtPort="in:0"/>
                <Link srcId="4efed069-fbe4-42b4-84f5-418fa5488257" srcPort="out:0" tgtId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" tgtPort="in:0"/>
                <Link srcId="77779a47-2c4b-4aed-8f85-cf080f562555" srcPort="dout:0" tgtId="c8abb6dc-3518-41c5-88a5-7e016006e3f4" tgtPort="in:0"/>
                <Link srcId="6783797e-0f4f-49c2-81b7-50906d504046" srcPort="dout:1" tgtId="328fbd82-fdae-41c6-8c16-c241c5f6da38" tgtPort="in:0"/>
                <Link srcId="e83941c2-c6d7-4806-8336-691f792d1fde" srcPort="out:0" tgtId="77779a47-2c4b-4aed-8f85-cf080f562555" tgtPort="in:0"/>
                <Link srcId="e83941c2-c6d7-4806-8336-691f792d1fde" srcPort="out:0" tgtId="6783797e-0f4f-49c2-81b7-50906d504046" tgtPort="in:0"/>
                <Link srcId="6783797e-0f4f-49c2-81b7-50906d504046" srcPort="dout:0" tgtId="2348b56b-9a33-4b0e-8a3e-1f8460ca4a4c" tgtPort="in:0"/>
                <Link srcId="e83941c2-c6d7-4806-8336-691f792d1fde" srcPort="out:0" tgtId="6d89e7d0-9df0-4c7f-8f9a-4a61a4dc2072" tgtPort="in:0"/>
                <Link srcId="328fbd82-fdae-41c6-8c16-c241c5f6da38" srcPort="dout:0" tgtId="4efed069-fbe4-42b4-84f5-418fa5488257" tgtPort="in:0"/>
                <Link srcId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" srcPort="out:0" tgtId="60d1ab54-b1e5-466d-886a-d566772cdc1b" tgtPort="din:0"/>
                <Link srcId="6d89e7d0-9df0-4c7f-8f9a-4a61a4dc2072" srcPort="dout:0" tgtId="5f5f2582-13cd-46eb-8b21-b7894c459c28" tgtPort="in:0"/>
                <Link srcId="5f5f2582-13cd-46eb-8b21-b7894c459c28" srcPort="out:0" tgtId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" tgtPort="in:0"/>
                <Link srcId="04ac791e-25cd-4c05-88e3-f093d50eb330" srcPort="out:0" tgtId="62838e97-64f5-4e62-872f-16d5e1dabdc2" tgtPort="din:0"/>
                <Codes/>
                <Libraries/>
                <Resources/>
                <Properties>[{&quot;editorType&quot;:&quot;number&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;agg_stopBatchCount&quot;,&quot;label&quot;:&quot;Stop After n Microbatch&quot;,&quot;type&quot;:&quot;integer&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:0,&quot;constraints&quot;:{&quot;min&quot;:&quot;0&quot;,&quot;max&quot;:&quot;999999&quot;,&quot;step&quot;:&quot;1&quot;,&quot;places&quot;:&quot;&quot;,&quot;maxLength&quot;:&quot;&quot;},&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;agg_source_group&quot;,&quot;label&quot;:&quot;Source Group&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;agg_source&quot;,&quot;label&quot;:&quot;Source Group Prefix&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;atimezone&quot;,&quot;label&quot;:&quot;Time Zone&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;Etc/GMT&quot;,&quot;enumSource&quot;:&quot;rest:/global/?op=get.timezones&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;timeSetting&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;timeSetting&quot;,&quot;label&quot;:&quot;Time Setting&quot;,&quot;type&quot;:&quot;object&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:{&quot;timeSettingValue&quot;:{&quot;timeType&quot;:&quot;event&quot;,&quot;eventField&quot;:&quot;ts&quot;,&quot;hbChecked&quot;:false,&quot;oooChecked&quot;:false,&quot;hbDelay&quot;:&quot;30/S&quot;,&quot;oooDelay&quot;:&quot;30/S&quot;}},&quot;constraints&quot;:{&quot;type&quot;:&quot;timeSetting&quot;,&quot;args&quot;:{}},&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false,&quot;group&quot;:&quot;group&quot;,&quot;groupLabel&quot;:&quot;Window&quot;},{&quot;editorType&quot;:&quot;windowSetting&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;windowSetting&quot;,&quot;label&quot;:&quot;Window Setting&quot;,&quot;type&quot;:&quot;object&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:{&quot;windowSize&quot;:&quot;5/N&quot;,&quot;windowInterval&quot;:&quot;5/N&quot;,&quot;windowPolicy&quot;:&quot;time&quot;},&quot;constraints&quot;:{&quot;type&quot;:&quot;windowSetting&quot;,&quot;args&quot;:{}},&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false,&quot;group&quot;:&quot;group&quot;,&quot;groupLabel&quot;:&quot;Window&quot;},{&quot;name&quot;:&quot;dimensions&quot;,&quot;label&quot;:&quot;Dimension fields&quot;,&quot;type&quot;:&quot;string&quot;,&quot;editorType&quot;:&quot;fieldMultiSelect&quot;,&quot;editorID&quot;:&quot;_dimension&quot;,&quot;constraints&quot;:{&quot;type&quot;:&quot;fieldMultiSelect&quot;,&quot;args&quot;:{&quot;nodeType&quot;:&quot;all&quot;}},&quot;sourceSchemaSensitive&quot;:true,&quot;value&quot;:[],&quot;runtimeControl&quot;:false,&quot;group&quot;:&quot;group1&quot;,&quot;groupLabel&quot;:&quot;Aggregate&quot;},{&quot;editorType&quot;:&quot;measureSetting&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group1&quot;,&quot;groupLabel&quot;:&quot;Aggregate&quot;,&quot;name&quot;:&quot;measures&quot;,&quot;label&quot;:&quot;Measure Fields&quot;,&quot;type&quot;:&quot;object&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:[{&quot;type&quot;:&quot;count&quot;,&quot;field&quot;:&quot;&quot;,&quot;asName&quot;:&quot;count&quot;},{&quot;type&quot;:&quot;window_end_time&quot;,&quot;field&quot;:&quot;&quot;,&quot;asName&quot;:&quot;aggr_end_tm&quot;}],&quot;constraints&quot;:{&quot;type&quot;:&quot;measureSetting&quot;,&quot;args&quot;:{}},&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group2&quot;,&quot;groupLabel&quot;:&quot;Audit&quot;,&quot;name&quot;:&quot;agg_dropped_events&quot;,&quot;label&quot;:&quot;Dropped Events Table&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;boolean&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group2&quot;,&quot;groupLabel&quot;:&quot;Audit&quot;,&quot;name&quot;:&quot;agg_doaudit&quot;,&quot;label&quot;:&quot;Audit Log&quot;,&quot;type&quot;:&quot;boolean&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;true&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group2&quot;,&quot;groupLabel&quot;:&quot;Audit&quot;,&quot;name&quot;:&quot;agg_audit_table_folder&quot;,&quot;label&quot;:&quot;Audit Log Table&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false}]</Properties>
              </Flow>
            </__subflow__>
            <__binding__><![CDATA[{"agg_source_group":"source_group","atimezone":"timezone","agg_stopBatchCount":"stopBatchCount","agg_source":"fsource","agg_audit_table_folder":"auditUrl","agg_doaudit":"enableAudit","agg_dropped_events":"agg_dropped_events"}]]></__binding__>
          </Model>
        </Node>
        <Node index="1008" uuid="7290c519-f686-4c42-81e9-b5ab7b9e3bb9" type="subflow" label="MetricOutput" x="1240" y="40" width="130" height="75">
          <Source name="source1" uid="0" outputType="DStream" dataType="class:NormalizeAggregatedOutput_Class">
            <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="6c378ec5-4ded-4a29-8ddf-eb56c81a3b29">
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="dom" label="dom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="dhost" label="dhost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
            </DataSource>
          </Source>
          <Output name="Out" uid="0" outputType="DStream" dataType="String">
            <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
          </Output>
          <Model>
            <Properties>
{&quot;subFlow&quot;:&quot;remote:///viaops.ingestion/MetricOutput&quot;,&quot;output_stopBatchCount&quot;:0,&quot;OPERATION_MODE&quot;:&quot;Both&quot;,&quot;output_source_group&quot;:&quot;&quot;,&quot;output_source&quot;:&quot;&quot;,&quot;motimezone&quot;:&quot;Etc/GMT&quot;,&quot;HISTORY_TABLE_FOLDER&quot;:&quot;&quot;,&quot;output_partition_keys&quot;:[&quot;date_key&quot;,&quot;metric_name&quot;],&quot;history_table_name&quot;:&quot;&quot;,&quot;ANOMALY_TARGET_FILENAME&quot;:&quot;&quot;,&quot;anomalyFileNamePrefix&quot;:&quot;&quot;,&quot;output_doaudit&quot;:&quot;true&quot;,&quot;output_audit_table_folder&quot;:&quot;&quot;}
</Properties>
            <__subflow__>
              <Flow index="1008" uuid="MetricOutput" isNested="true" revision="4189" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/MetricOutput" name="MetricOutput" showFooter="true">
                <Node index="1008_1" uuid="83dcd221-9159-46d5-8fb4-b6c524c69c02" type="inPort" label="source1" x="100" y="83" width="72.703125" height="40">
                  <Output name="out" uid="0" outputType="DStream" dataType="class:NormalizeAggregatedOutput_Class">
                    <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_value" label="metric_value" type="double" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="host" label="host" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="dom" label="dom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="dhost" label="dhost" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="reason" label="reason" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model>
                    <Properties>
{&quot;portType&quot;:&quot;DStream&quot;}
</Properties>
                  </Model>
                </Node>
                <Node index="1008_2" uuid="16257540-b127-448a-8891-c8a71a46df04" type="StreamTarget" label="Stream to Anomaly Detection" x="560" y="120" width="130" height="75">
                  <Source name="source" uid="0" outputType="DStream" dataType="class:NormalizeAggregatedOutput_Class">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="a2992e48-a216-41c5-857a-5230e14d64a6">
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dom" label="dom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dhost" label="dhost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="out" uid="0" outputType="DStream" dataType="class:NormalizeAggregatedOutput_Class">
                    <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_value" label="metric_value" type="double" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="host" label="host" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="dom" label="dom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="dhost" label="dhost" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="reason" label="reason" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model type="file" url="${ANOMALY_TARGET_FILENAME}" namePrefix="${anomalyFileNamePrefix}" format="json" partitionNum="1" dataSpeed="" dataVolume="">
                    <__binding__><![CDATA[{"fileNamePrefix":""}]]></__binding__>
                  </Model>
                </Node>
                <Node index="1008_3" uuid="cfde6cfb-7498-4b34-8dfc-62eb71da9bb4" type="Adhoc" label="Persist History Table" x="560" y="31" width="130" height="75">
                  <Source name="source1" uid="0" outputType="DStream" dataType="class:NormalizeAggregatedOutput_Class">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="73490184-781b-4acb-8f0e-500cca2f6ad9">
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dom" label="dom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dhost" label="dhost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="Out1" uid="0" outputType="DStream" dataType="String" referenceType="string">
                    <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model>
                    <Script><![CDATA[
import org.apache.hadoop.conf.Configuration
import org.apache.hadoop.fs.{FileStatus, FileSystem, Path}
import java.net.URI
import org.apache.hadoop.fs.PathFilter
import java.util.UUID

def copydir(fs: FileSystem, src: Path, dest: Path): Unit = {
    val children = fs.listStatus(src)
    children.foreach(child => {
        val targetPath = new Path(dest, child.getPath.getName)
        if (child.isDirectory()) {
            val result = fs.mkdirs(targetPath)
            copydir(fs, child.getPath, targetPath)
        } else if (!"_SUCCESS".equals(child.getPath.getName)) {
            var realtarget = new Path(dest, "${output_source}-"+child.getPath.getName)
            if (fs.exists(targetPath)) {
                realtarget = new Path(dest, "${output_source}-"+UUID.randomUUID.toString+"-"+child.getPath.getName)
            }
            fs.rename(child.getPath, realtarget)
        }
    })
    fs.delete(src, true)
}

def getKeyValues(fs: FileSystem, folderName: String, key: String) : Array[String] = {
    val statuses: Array[FileStatus] = fs.listStatus(new Path(folderName))
    val keyvalues: Array[String] = statuses.filter(_.isDirectory).map(_.getPath.getName).filter(_.startsWith(key + "="))
    keyvalues
}

def getSubfolder(fs: FileSystem, folderName: String, keys: Array[String]) : Array[String] = {
    if (keys.length == 0) {
        Array[String]()
    } else {
        val currentkey = keys(0)
        val keyvalues = getKeyValues(fs, folderName, currentkey)

        if (keys.length > 1) {
            keyvalues.flatMap(kv => {
                val subkeyvalues = getSubfolder(fs, folderName.concat("/").concat(kv), keys.drop(1)).map(kv.concat(",").concat(_))
                subkeyvalues
            })
        } else {
            keyvalues
        }
    }
}

def folderNotExist(fs: FileSystem, baseName: String, subName: String): Boolean = {
    !fs.exists(new Path(baseName, subName))
}

val basefolder = "${HISTORY_TABLE_FOLDER}"
val tempfolder = java.util.UUID.randomUUID.toString
//   val tempfolder = "${__flowIndex__}"
val partitionkeys = "${output_partition_keys}".replaceAll("\\[|\\]", "").split(',').map(x => x.trim())

//prepare sql
val historyTableName = "${history_table_name}"
val tempSB = new StringBuilder()
val selectSQL = """select distinct concat(""" + partitionkeys.map(k => s"""concat("$k=", $k)""").addString(tempSB, """ , "/" , """) + s""") from tempMetricOutput"""
//println("==================" + selectSQL)
val repairSQL = "MSCK REPAIR TABLE %s".format(historyTableName)
//println("==================" + repairSQL)
val partitionNum: Int = 1

source1.foreachRDD(rdd => {
    val fs = FileSystem.get(URI.create(basefolder), new Configuration)
    
    //println("================= start get partition")
    //val partitions: Array[String] = if (fs.exists(new Path(basefolder))) {getSubfolder(fs, basefolder, partitionkeys)} else {Array[String]()}
    //println("================= end get partition")
    //partitions.foreach(println)
    
    var needrepair: Boolean = false
    
    val src = new Path(basefolder, tempfolder)
    val dest = new Path(basefolder)
    val df = hiveContext.createDataFrame(rdd)
    
    df.createOrReplaceTempView("tempMetricOutput")
    //println("================= start select hive")
    val arrayP = hiveContext.sql(selectSQL).map(_.getString(0)).collect()
    needrepair = arrayP.exists(ps => folderNotExist(fs, basefolder, ps))
    
    //arrayP.foreach(pvalue => {
    //    println("===============" + pvalue)
    //})
    //println("=============== needrepair: " + needrepair)
    //println("================= end select hive")
    
    df.repartition(partitionNum).write.mode("append").partitionBy(partitionkeys:_*).parquet(src.toUri().toString())
    copydir(fs, src, dest)
    
    //repair table
    if (needrepair) {
        //println("================= repair table")
        if(hiveContext.tableNames.contains(historyTableName)) {
            hiveContext.sql(repairSQL)
        }
        //println("================= end repair table")
    }
})

val retval = source1.map(i => "")   ]]></Script>
                  </Model>
                </Node>
                <Node index="1008_4" uuid="b4c41092-f31d-4ad0-809f-b82569d544b5" type="Aggregate" label="Count Output Events" x="560" y="206" width="130" height="75">
                  <Source name="source" uid="0" outputType="DStream" dataType="class:NormalizeAggregatedOutput_Class">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="9327217d-5098-4477-807b-3ee5d8b297d0">
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dom" label="dom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dhost" label="dhost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="out" uid="0" outputType="DStream" dataType="(Long,Long)">
                    <Field name="count" label="count" type="long" isArray="false" isOptional="false"/>
                    <Field name="micro_batch_time" label="micro_batch_time" type="long" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model _caseClass="" isClassRef="false">
                    <Measures>
                      <Measure type="count" field="" asName="count"/>
                      <Measure type="micro_batch_time" field="" asName="micro_batch_time"/>
                    </Measures>
                    <Window enable="false"/>
                  </Model>
                </Node>
                <Node index="1008_5" uuid="1191f81c-7709-4100-8afd-2b5d3d3d8c2c" type="Compute" label="Conver to metrics (Output Events)" x="753" y="212" width="130" height="75">
                  <Source name="source" uid="0" outputType="DStream" dataType="(Long,Long)">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="b4c41092-f31d-4ad0-809f-b82569d544b5">
                      <Field name="count" label="count" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      <Field name="micro_batch_time" label="micro_batch_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                    <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                    <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
                    <Computes>
                      <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${motimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;Total Output Events&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="count" outputType="string" alias="metric_value" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;sum&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;Count&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;${output_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="if(${output_stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;${motimezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;${output_source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
                    </Computes>
                    <CheckboxStatus isChecked="false"/>
                  </Model>
                </Node>
                <Node index="1008_6" uuid="73490184-781b-4acb-8f0e-500cca2f6ad9" type="Filter" label="Filter History Target" x="340" y="32" width="130" height="75">
                  <Source name="source" uid="0" outputType="DStream" dataType="class:NormalizeAggregatedOutput_Class">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="83dcd221-9159-46d5-8fb4-b6c524c69c02">
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dom" label="dom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dhost" label="dhost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="out" uid="0" outputType="DStream" dataType="class:NormalizeAggregatedOutput_Class">
                    <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_value" label="metric_value" type="double" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="host" label="host" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="dom" label="dom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="dhost" label="dhost" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="reason" label="reason" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model filterModel="form">
                    <Filters>
                      <Filter field="" op="sleText" arg="" value="" sleText="&quot;${OPERATION_MODE}&quot; = &quot;History&quot; || &quot;${OPERATION_MODE}&quot; = &quot;Both&quot;"/>
                    </Filters>
                  </Model>
                </Node>
                <Node index="1008_7" uuid="a2992e48-a216-41c5-857a-5230e14d64a6" type="Filter" label="Filter Anomaly HDFS Target" x="340" y="120" width="130" height="75">
                  <Source name="source" uid="0" outputType="DStream" dataType="class:NormalizeAggregatedOutput_Class">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="83dcd221-9159-46d5-8fb4-b6c524c69c02">
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dom" label="dom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dhost" label="dhost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="out" uid="0" outputType="DStream" dataType="class:NormalizeAggregatedOutput_Class">
                    <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_value" label="metric_value" type="double" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="host" label="host" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="dom" label="dom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="dhost" label="dhost" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="reason" label="reason" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model filterModel="form">
                    <Filters>
                      <Filter field="" op="sleText" arg="" value="" sleText="&quot;${OPERATION_MODE}&quot; = &quot;Anomaly&quot; || &quot;${OPERATION_MODE}&quot; = &quot;Both&quot;"/>
                    </Filters>
                  </Model>
                </Node>
                <Node index="1008_8" uuid="9327217d-5098-4477-807b-3ee5d8b297d0" type="Filter" label="Enable Audit Log" x="340" y="206" width="130" height="75">
                  <Source name="source" uid="0" outputType="DStream" dataType="class:NormalizeAggregatedOutput_Class">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="83dcd221-9159-46d5-8fb4-b6c524c69c02">
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dom" label="dom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dhost" label="dhost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="out" uid="0" outputType="DStream" dataType="class:NormalizeAggregatedOutput_Class">
                    <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_value" label="metric_value" type="double" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="host" label="host" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="dom" label="dom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="dhost" label="dhost" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="reason" label="reason" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model filterModel="form">
                    <Filters>
                      <Filter field="" op="sleText" arg="" value="" sleText="&quot;${output_doaudit}&quot; = &quot;True&quot; || &quot;${output_doaudit}&quot; = &quot;true&quot;"/>
                    </Filters>
                  </Model>
                </Node>
                <Node index="1008_9" uuid="e99c3916-b95e-42d2-8934-2213520a1964" type="outPort" label="Out" x="734" y="51" width="70" height="40">
                  <Source name="source" uid="0" outputType="DStream" dataType="String">
                    <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="cfde6cfb-7498-4b34-8dfc-62eb71da9bb4">
                      <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Model>
                    <Properties>
{}
</Properties>
                  </Model>
                </Node>
                <Node index="1008_10" uuid="c36d7cb3-796a-4b7d-81b3-299bcebd9b6a" type="subflow" label="AuditLog" x="940" y="207" width="130" height="75">
                  <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="1191f81c-7709-4100-8afd-2b5d3d3d8c2c">
                      <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                    <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                    <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model>
                    <Properties>
{&quot;subFlow&quot;:&quot;remote:///viaops.ingestion/AuditLog&quot;,&quot;audit_parquetfolder&quot;:&quot;${output_audit_table_folder}&quot;,&quot;source&quot;:&quot;${output_source}&quot;}
</Properties>
                    <__subflow__>
                      <Flow index="1008_10" uuid="AuditLog" isNested="true" revision="800" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/AuditLog" name="AuditLog" showFooter="true">
                        <Node index="1008_10_1" uuid="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" type="inPort" label="In" x="20" y="34" width="70" height="40">
                          <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog" referenceType="viaops.ingestion.AuditLog">
                            <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                            <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                          </Output>
                          <Model>
                            <Properties>
{&quot;portType&quot;:&quot;DStream&quot;,&quot;type&quot;:{&quot;name&quot;:&quot;viaops.ingestion.AuditLog&quot;,&quot;kind&quot;:&quot;caseclass&quot;}}
</Properties>
                          </Model>
                        </Node>
                        <Node index="1008_10_2" uuid="2a748b73-8ff7-4d04-8666-9123dfba32f3" type="outPort" label="Out" x="440" y="34" width="70" height="40">
                          <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                            <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                              <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                            </DataSource>
                          </Source>
                          <Model>
                            <Properties>
{&quot;type&quot;:{&quot;name&quot;:&quot;viaops.ingestion.AuditLog&quot;,&quot;kind&quot;:&quot;caseclass&quot;}}
</Properties>
                          </Model>
                        </Node>
                        <Node index="1008_10_3" uuid="322e4e59-dd18-4247-8532-ecf44de32e0b" type="Compute" label="Normalize" x="140" y="110" width="130" height="75">
                          <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                            <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                              <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                            </DataSource>
                          </Source>
                          <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                            <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                            <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                          </Output>
                          <Model _caseClass="AuditLogTable" isClassRef="true">
                            <Computes>
                              <Compute op="sleText" field="*" arg="" value="date_key" outputType="long" alias="date_key" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="aggr_start_tm" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="aggr_end_tm" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="metric_name" outputType="string" alias="metric_name" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="metric_value" outputType="string" alias="metric_value" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="metric_uom" outputType="string" alias="metric_uom" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="uom_label" outputType="string" alias="uom_label" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="source_group" outputType="string" alias="source_group" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="system_tm" outputType="long" alias="system_tm" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="process_type" outputType="string" alias="process_type" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="aggr_type" outputType="string" alias="aggr_type" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="source_fmt" outputType="string" alias="source_fmt" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="source_tz" outputType="string" alias="source_tz" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="&quot;${source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="ts_key" outputType="string" alias="ts_key" wordWarp="true"/>
                              <Compute op="sleText" field="*" arg="" value="ts_value" outputType="string" alias="ts_value" wordWarp="true"/>
                            </Computes>
                            <CheckboxStatus isChecked="false"/>
                          </Model>
                        </Node>
                        <Node index="1008_10_4" uuid="15ea36d5-561f-4969-8443-62afe82d4154" type="StreamTarget" label="Step 1" x="340" y="110" width="130" height="75">
                          <Source name="source" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                            <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="322e4e59-dd18-4247-8532-ecf44de32e0b">
                              <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                            </DataSource>
                          </Source>
                          <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                            <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                            <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                            <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                            <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                          </Output>
                          <Model type="hiveTable" tableName="${audit_parquetfolder}" partitionType="eventField" partitionSize="" partitionColumn="date_key,source_group" partitionIndex="0,7" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
                            <__binding__><![CDATA[{"snapshotTableName":""}]]></__binding__>
                          </Model>
                        </Node>
                        <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="322e4e59-dd18-4247-8532-ecf44de32e0b" tgtPort="in:0"/>
                        <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="2a748b73-8ff7-4d04-8666-9123dfba32f3" tgtPort="in:0"/>
                        <Link srcId="322e4e59-dd18-4247-8532-ecf44de32e0b" srcPort="out:0" tgtId="15ea36d5-561f-4969-8443-62afe82d4154" tgtPort="in:0"/>
                        <Codes/>
                        <Libraries/>
                        <Resources/>
                        <Properties>[{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;common&quot;,&quot;name&quot;:&quot;audit_parquetfolder&quot;,&quot;label&quot;:&quot;Audit Log Table&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;viaops_ingestion_auditlog&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;common&quot;,&quot;name&quot;:&quot;source&quot;,&quot;label&quot;:&quot;Source Group Prefix&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false}]</Properties>
                        <Types>[{&quot;name&quot;:&quot;AuditLogTable&quot;,&quot;schema&quot;:[{&quot;name&quot;:&quot;date_key&quot;,&quot;type&quot;:&quot;long&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;aggr_start_tm&quot;,&quot;type&quot;:&quot;long&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;aggr_end_tm&quot;,&quot;type&quot;:&quot;long&quot;,&quot;_isOptional&quot;:true,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;metric_name&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;metric_value&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;metric_uom&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;uom_label&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;source_group&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;system_tm&quot;,&quot;type&quot;:&quot;long&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;process_type&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;aggr_type&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;source_fmt&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;source_tz&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;source_group_prefix&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;ts_key&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false},{&quot;name&quot;:&quot;ts_value&quot;,&quot;type&quot;:&quot;string&quot;,&quot;_isOptional&quot;:false,&quot;_isArray&quot;:false}]}]</Types>
                      </Flow>
                    </__subflow__>
                  </Model>
                </Node>
                <Link srcId="1191f81c-7709-4100-8afd-2b5d3d3d8c2c" srcPort="out:0" tgtId="c36d7cb3-796a-4b7d-81b3-299bcebd9b6a" tgtPort="din:0"/>
                <Link srcId="cfde6cfb-7498-4b34-8dfc-62eb71da9bb4" srcPort="dout:0" tgtId="e99c3916-b95e-42d2-8934-2213520a1964" tgtPort="in:0"/>
                <Link srcId="9327217d-5098-4477-807b-3ee5d8b297d0" srcPort="out:0" tgtId="b4c41092-f31d-4ad0-809f-b82569d544b5" tgtPort="in:0"/>
                <Link srcId="83dcd221-9159-46d5-8fb4-b6c524c69c02" srcPort="out:0" tgtId="9327217d-5098-4477-807b-3ee5d8b297d0" tgtPort="in:0"/>
                <Link srcId="73490184-781b-4acb-8f0e-500cca2f6ad9" srcPort="out:0" tgtId="cfde6cfb-7498-4b34-8dfc-62eb71da9bb4" tgtPort="din:0"/>
                <Link srcId="83dcd221-9159-46d5-8fb4-b6c524c69c02" srcPort="out:0" tgtId="73490184-781b-4acb-8f0e-500cca2f6ad9" tgtPort="in:0"/>
                <Link srcId="b4c41092-f31d-4ad0-809f-b82569d544b5" srcPort="dout:0" tgtId="1191f81c-7709-4100-8afd-2b5d3d3d8c2c" tgtPort="in:0"/>
                <Link srcId="83dcd221-9159-46d5-8fb4-b6c524c69c02" srcPort="out:0" tgtId="a2992e48-a216-41c5-857a-5230e14d64a6" tgtPort="in:0"/>
                <Link srcId="a2992e48-a216-41c5-857a-5230e14d64a6" srcPort="out:0" tgtId="16257540-b127-448a-8891-c8a71a46df04" tgtPort="in:0"/>
                <Codes/>
                <Libraries/>
                <Resources/>
                <Properties>[{&quot;editorType&quot;:&quot;number&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;output_stopBatchCount&quot;,&quot;label&quot;:&quot;Stop After n Microbatch&quot;,&quot;type&quot;:&quot;integer&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:0,&quot;constraints&quot;:{&quot;min&quot;:&quot;0&quot;,&quot;max&quot;:&quot;999999&quot;,&quot;step&quot;:&quot;1&quot;,&quot;places&quot;:&quot;&quot;,&quot;maxLength&quot;:&quot;&quot;},&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;sparkSelect&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;,&quot;options.History&quot;:&quot;constraints.args.options.0.label&quot;,&quot;options.Anomaly&quot;:&quot;constraints.args.options.1.label&quot;,&quot;options.Both&quot;:&quot;constraints.args.options.2.label&quot;},&quot;name&quot;:&quot;OPERATION_MODE&quot;,&quot;label&quot;:&quot;Operation Mode&quot;,&quot;desc&quot;:&quot;Controls output target routing to History table and/or Anomaly HDFS Target&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;Both&quot;,&quot;constraints&quot;:{&quot;type&quot;:&quot;sparkSelect&quot;,&quot;args&quot;:{&quot;options&quot;:[{&quot;label&quot;:&quot;History&quot;,&quot;value&quot;:&quot;History&quot;},{&quot;label&quot;:&quot;Anomaly&quot;,&quot;value&quot;:&quot;Anomaly&quot;},{&quot;label&quot;:&quot;Both&quot;,&quot;value&quot;:&quot;Both&quot;}],&quot;needPlaceholder&quot;:true,&quot;multiple&quot;:false,&quot;url&quot;:&quot;http://10.101.7.163:18080/vitria-oi/rest/app/spark/space/VIAOps Ingestion/sparkm/VIAOps - Aggregate Output MetricReferenceData Template&quot;,&quot;_cid&quot;:&quot;510cb45b-ed25-4eef-89de-952be285ee4c&quot;,&quot;name&quot;:&quot;value&quot;}},&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;output_source_group&quot;,&quot;label&quot;:&quot;Source Group&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;output_source&quot;,&quot;label&quot;:&quot;Source Group Prefix&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;motimezone&quot;,&quot;label&quot;:&quot;Time Zone&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;Etc/GMT&quot;,&quot;enumSource&quot;:&quot;rest:/global/?op=get.timezones&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group&quot;,&quot;groupLabel&quot;:&quot;Target&quot;,&quot;name&quot;:&quot;HISTORY_TABLE_FOLDER&quot;,&quot;label&quot;:&quot;Spark SQL Table URL&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;fieldMultiSelect&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group&quot;,&quot;name&quot;:&quot;output_partition_keys&quot;,&quot;label&quot;:&quot;Partition Fields&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;controlValue&quot;:&quot;&quot;,&quot;constraints&quot;:{&quot;type&quot;:&quot;fieldMultiSelect&quot;,&quot;args&quot;:{&quot;nodeType&quot;:&quot;primitive&quot;,&quot;sourcePrefix&quot;:false,&quot;sourceName&quot;:&quot;&quot;,&quot;expandArray&quot;:false,&quot;types&quot;:[&quot;string&quot;,&quot;boolean&quot;,&quot;integer&quot;,&quot;long&quot;,&quot;double&quot;,&quot;float&quot;,&quot;date&quot;,&quot;time&quot;,&quot;datetime&quot;,&quot;array&quot;]}},&quot;sourceSchemaSensitive&quot;:true,&quot;runtimeControl&quot;:false,&quot;groupLabel&quot;:&quot;Target&quot;},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group&quot;,&quot;groupLabel&quot;:&quot;Target&quot;,&quot;name&quot;:&quot;history_table_name&quot;,&quot;label&quot;:&quot;Spark SQL Table&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group&quot;,&quot;groupLabel&quot;:&quot;Target&quot;,&quot;name&quot;:&quot;ANOMALY_TARGET_FILENAME&quot;,&quot;label&quot;:&quot;Anomaly File URL&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;anomalyFileNamePrefix&quot;,&quot;label&quot;:&quot;Anomaly File Name Prefix&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:&quot;true&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false,&quot;group&quot;:&quot;group&quot;,&quot;groupLabel&quot;:&quot;Target&quot;},{&quot;editorType&quot;:&quot;boolean&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group2&quot;,&quot;groupLabel&quot;:&quot;Audit&quot;,&quot;name&quot;:&quot;output_doaudit&quot;,&quot;label&quot;:&quot;Audit Log&quot;,&quot;type&quot;:&quot;boolean&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;true&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group2&quot;,&quot;groupLabel&quot;:&quot;Audit&quot;,&quot;name&quot;:&quot;output_audit_table_folder&quot;,&quot;label&quot;:&quot;Audit Log Table&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false}]</Properties>
              </Flow>
            </__subflow__>
            <__binding__><![CDATA[{"output_stopBatchCount":"stopBatchCount","OPERATION_MODE":"operationMode","output_source_group":"source_group","output_source":"fsource","motimezone":"timezone","HISTORY_TABLE_FOLDER":"historyFolder","ANOMALY_TARGET_FILENAME":"streamFolder","anomalyFileNamePrefix":"anomalyFileNamePrefix","output_doaudit":"enableAudit","output_audit_table_folder":"auditUrl","history_table_name":"history_table_name"}]]></__binding__>
          </Model>
        </Node>
        <Node index="1009" uuid="2bd99a38-fd37-46d8-89b7-a0dec4e25f00" type="subflow" label="DroppedEvents" x="309" y="180" width="130" height="75">
          <Source name="In" uid="0" outputType="DStream" dataType="(String,String)">
            <DataSource category="#OUTPUT" id="undefined" name="Dropped" nodeId="5f665fa4-8262-43a7-8ba3-e96e06444426">
              <Field name="___error___" label="error" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
            </DataSource>
          </Source>
          <Output name="Out" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
            <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
            <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
            <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
            <Field name="event" label="event" type="string" clazz="" isArray="false" isOptional="false"/>
            <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
          </Output>
          <Model>
            <Properties>
{&quot;subFlow&quot;:&quot;remote:///viaops.ingestion/DroppedEvents&quot;,&quot;drop_source_group&quot;:&quot;&quot;,&quot;drop_source&quot;:&quot;&quot;,&quot;drop_sparksqltable&quot;:&quot;&quot;,&quot;vtimezone&quot;:&quot;Etc/GMT&quot;}
</Properties>
            <__subflow__>
              <Flow index="1009" uuid="DroppedEvents" isNested="true" revision="672" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/DroppedEvents" name="DroppedEvents" showFooter="true">
                <Node index="1009_1" uuid="cd64c670-6c5f-440e-8b66-441c760166d8" type="inPort" label="In" x="240" y="32" width="70" height="40">
                  <Output name="Out" uid="0" outputType="DStream" dataType="(String,String)" referenceType="viaops.ingestion.DroppedEvents">
                    <Field name="___error___" label="error" type="string" isArray="false" isOptional="false"/>
                    <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model>
                    <Properties>
{&quot;portType&quot;:&quot;DStream&quot;,&quot;type&quot;:{&quot;name&quot;:&quot;viaops.ingestion.DroppedEvents&quot;,&quot;kind&quot;:&quot;caseclass&quot;}}
</Properties>
                  </Model>
                </Node>
                <Node index="1009_2" uuid="41a6a5ab-b013-4059-854b-b4d7a89ef9a0" type="Compute" label="to Dropped Events" x="366" y="10" width="130" height="75">
                  <Source name="source" uid="0" outputType="DStream" dataType="(String,String)">
                    <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="cd64c670-6c5f-440e-8b66-441c760166d8">
                      <Field name="___error___" label="error" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="out" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                    <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="event" label="event" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model _caseClass="toDroppedEvents_Class" isClassRef="false" udfs="generate_datekey">
                    <Computes>
                      <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${vtimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;${drop_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="&quot;${drop_source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="error" outputType="string" alias="error" wordWarp="true"/>
                      <Compute op="sleText" field="*" arg="" value="data" outputType="string" alias="event" wordWarp="true"/>
                    </Computes>
                    <CheckboxStatus isChecked="mixed"/>
                  </Model>
                </Node>
                <Node index="1009_3" uuid="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3" type="StreamTarget" label="write to Hive" x="560" y="9" width="130" height="75">
                  <Source name="source" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="41a6a5ab-b013-4059-854b-b4d7a89ef9a0">
                      <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="event" label="event" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Output name="out" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                    <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                    <Field name="event" label="event" type="string" clazz="" isArray="false" isOptional="false"/>
                    <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                  </Output>
                  <Model type="hiveTable" tableName="${drop_sparksqltable}" partitionType="eventField" partitionSize="" partitionColumn="date_key" partitionIndex="0" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume=""/>
                </Node>
                <Node index="1009_4" uuid="dd779a23-bc63-4200-8e22-05639b978a68" type="outPort" label="Out" x="746" y="29" width="70" height="40">
                  <Source name="source" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                    <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3">
                      <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      <Field name="event" label="event" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                    </DataSource>
                  </Source>
                  <Model>
                    <Properties>
{&quot;type&quot;:{&quot;name&quot;:&quot;viaops.ingestion.DroppedEvents&quot;,&quot;kind&quot;:&quot;caseclass&quot;}}
</Properties>
                  </Model>
                </Node>
                <Link srcId="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3" srcPort="out:0" tgtId="dd779a23-bc63-4200-8e22-05639b978a68" tgtPort="in:0"/>
                <Link srcId="41a6a5ab-b013-4059-854b-b4d7a89ef9a0" srcPort="out:0" tgtId="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3" tgtPort="in:0"/>
                <Link srcId="cd64c670-6c5f-440e-8b66-441c760166d8" srcPort="out:0" tgtId="41a6a5ab-b013-4059-854b-b4d7a89ef9a0" tgtPort="in:0"/>
                <Codes/>
                <Libraries/>
                <Resources/>
                <Properties>[{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;common&quot;,&quot;name&quot;:&quot;drop_source_group&quot;,&quot;label&quot;:&quot;Source Group&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;common&quot;,&quot;name&quot;:&quot;drop_source&quot;,&quot;label&quot;:&quot;Source Group Prefix&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;common&quot;,&quot;name&quot;:&quot;drop_sparksqltable&quot;,&quot;label&quot;:&quot;Dropped Events Table&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;common&quot;,&quot;name&quot;:&quot;vtimezone&quot;,&quot;label&quot;:&quot;Time Zone&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;Etc/GMT&quot;,&quot;defaultValueForExisted&quot;:&quot;Europe/London&quot;,&quot;enumSource&quot;:&quot;rest:/global/?op=get.timezones&quot;,&quot;runtimeControl&quot;:false}]</Properties>
              </Flow>
            </__subflow__>
            <__binding__><![CDATA[{"drop_source_group":"source_group","drop_source":"fsource","drop_sparksqltable":"agg_dropped_events","vtimezone":"timezone"}]]></__binding__>
          </Model>
        </Node>
        <Link srcId="4a019801-4853-477a-862d-7a888462e914" srcPort="dout:0" tgtId="5f665fa4-8262-43a7-8ba3-e96e06444426" tgtPort="in:0"/>
        <Link srcId="84d9b8fb-d76e-4d6b-87ae-5f6846925cec" srcPort="dout:0" tgtId="d3e86d1f-8c60-4618-827e-966bc2afda90" tgtPort="din:1"/>
        <Link srcId="5f665fa4-8262-43a7-8ba3-e96e06444426" srcPort="dout:0" tgtId="b6a2b4e9-3f7a-4f33-8684-2794f67555f9" tgtPort="in:0"/>
        <Link srcId="b6a2b4e9-3f7a-4f33-8684-2794f67555f9" srcPort="out:0" tgtId="d3e86d1f-8c60-4618-827e-966bc2afda90" tgtPort="din:0"/>
        <Link srcId="d3e86d1f-8c60-4618-827e-966bc2afda90" srcPort="out:0" tgtId="3b53a717-9dbe-4351-813c-c90f108d2158" tgtPort="din:0"/>
        <Link srcId="3b53a717-9dbe-4351-813c-c90f108d2158" srcPort="dout:0" tgtId="6c378ec5-4ded-4a29-8ddf-eb56c81a3b29" tgtPort="in:0"/>
        <Link srcId="6c378ec5-4ded-4a29-8ddf-eb56c81a3b29" srcPort="out:0" tgtId="7290c519-f686-4c42-81e9-b5ab7b9e3bb9" tgtPort="din:0"/>
        <Link srcId="5f665fa4-8262-43a7-8ba3-e96e06444426" srcPort="dout:1" tgtId="2bd99a38-fd37-46d8-89b7-a0dec4e25f00" tgtPort="din:0"/>
        <Codes>
          <Spark><![CDATA[########## The following properties are coming from UI configuration ###########
spark.master=${spark.master}
spark.cores.max=${spark.cores.max}
spark.executor.instances=${spark.executor.instances}
spark.executor.cores=${spark.executor.cores}
spark.executor.memory=${spark.executor.memory}
vitria.spark.driver.classpath=${vitria.spark.driver.classpath}
vitria.app.class=${vitria.app.class}
vitria.app.name=${vitria.app.name}
spark.sql.hive.thriftServer.singleSession=true
spark.serializer=org.apache.spark.serializer.KryoSerializer
spark.scheduler.minRegisteredResourcesRatio=1.0
vitria.spark.delete.checkpointdir=false
spark.sql.shuffle.partitions=4
spark.kryo.registrator=${spark.kryo.registrator}
spark.hadoop.cloneConf=true
########### Add your spark properties here ###########################
# vitria.sparkdriver.extraJavaOption=-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=18787
# spark.port.maxRetries=30]]></Spark>
          <Hive><![CDATA[########## The following properties are coming from UI configuration ###########
javax.jdo.option.ConnectionURL=${javax.jdo.option.ConnectionURL}
javax.jdo.option.ConnectionDriveName=${javax.jdo.option.ConnectionDriveName}
javax.jdo.option.ConnectionUserName=${javax.jdo.option.ConnectionUserName}
javax.jdo.option.ConnectionPassword=${javax.jdo.option.ConnectionPassword}
hive.server2.thrift.port=${hive.server2.thrift.port}
hive.db.schema=${hive.db.schema}
spark.sql.warehouse.dir=${hive.metastore.warehouse.dir}
hive.exec.dynamic.partition.mode=nonstrict
datanucleus.connectionPoolingType=DBCP
########### Add your hive properties here ###########################
]]></Hive>
        </Codes>
        <Libraries>
          <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/modules/com/vitria/driver/main/mysql-connector-java-*-bin.jar"/>
        </Libraries>
        <Resources/>
        <Properties>[{&quot;editorType&quot;:&quot;number&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;stopBatchCount&quot;,&quot;label&quot;:&quot;Stop After n Microbatch&quot;,&quot;type&quot;:&quot;integer&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:0,&quot;runtimeControl&quot;:false,&quot;constraints&quot;:{&quot;min&quot;:&quot;0&quot;,&quot;max&quot;:&quot;999999&quot;,&quot;step&quot;:&quot;1&quot;,&quot;places&quot;:&quot;&quot;,&quot;maxLength&quot;:&quot;&quot;,&quot;args&quot;:{}}},{&quot;editorType&quot;:&quot;sparkSelect&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;,&quot;options.History&quot;:&quot;constraints.args.options.0.label&quot;,&quot;options.Anomaly&quot;:&quot;constraints.args.options.1.label&quot;,&quot;options.Both&quot;:&quot;constraints.args.options.2.label&quot;},&quot;name&quot;:&quot;operationMode&quot;,&quot;label&quot;:&quot;Operation Mode&quot;,&quot;desc&quot;:&quot;Controls output target routing to History table and/or Anomaly HDFS Target&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;History&quot;,&quot;runtimeControl&quot;:false,&quot;constraints&quot;:{&quot;type&quot;:&quot;sparkSelect&quot;,&quot;args&quot;:{&quot;options&quot;:[{&quot;label&quot;:&quot;History&quot;,&quot;value&quot;:&quot;History&quot;},{&quot;label&quot;:&quot;Anomaly&quot;,&quot;value&quot;:&quot;Anomaly&quot;},{&quot;label&quot;:&quot;Both&quot;,&quot;value&quot;:&quot;Both&quot;}],&quot;needPlaceholder&quot;:true,&quot;multiple&quot;:false}}},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;source_group&quot;,&quot;label&quot;:&quot;Source Group&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;chtr_email&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;fsource&quot;,&quot;label&quot;:&quot;Source Group Prefix&quot;,&quot;desc&quot;:&quot;The source group prefix&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;cm_inbound&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;timezone&quot;,&quot;label&quot;:&quot;Time Zone&quot;,&quot;desc&quot;:&quot;The timezone to calculate date&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;Etc/GMT&quot;,&quot;defaultValueForExisted&quot;:&quot;Europe/London&quot;,&quot;enumSource&quot;:&quot;rest:/global/?op=get.timezones&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group&quot;,&quot;groupLabel&quot;:&quot;Source&quot;,&quot;name&quot;:&quot;sourceLocation&quot;,&quot;label&quot;:&quot;File URL&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;hdfs://zhihuitest/charter/s3/chtr_email/application/logs/cm/inbound&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group&quot;,&quot;groupLabel&quot;:&quot;Source&quot;,&quot;name&quot;:&quot;sourceFilter&quot;,&quot;label&quot;:&quot;File Filter&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;.*&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group&quot;,&quot;groupLabel&quot;:&quot;Source&quot;,&quot;name&quot;:&quot;maxBatchSize&quot;,&quot;label&quot;:&quot;Max Batch Size (MB)&quot;,&quot;desc&quot;:&quot;The max file size which will be processed in one batch&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:true,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;0&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;date&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group&quot;,&quot;groupLabel&quot;:&quot;Source&quot;,&quot;name&quot;:&quot;startDate&quot;,&quot;label&quot;:&quot;Start Date&quot;,&quot;desc&quot;:&quot;The start date constraint and empty means starting from oldest&quot;,&quot;type&quot;:&quot;date&quot;,&quot;optional&quot;:true,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;runtimeControl&quot;:false,&quot;constraints&quot;:{&quot;itemStyle&quot;:&quot;width: 200px;&quot;,&quot;supportNow&quot;:true,&quot;supportClear&quot;:&quot;true&quot;,&quot;args&quot;:{}}},{&quot;editorType&quot;:&quot;date&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group&quot;,&quot;groupLabel&quot;:&quot;Source&quot;,&quot;name&quot;:&quot;endDate&quot;,&quot;label&quot;:&quot;End Date&quot;,&quot;desc&quot;:&quot;End date constraint and empty means always process to latest time&quot;,&quot;type&quot;:&quot;date&quot;,&quot;optional&quot;:true,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;runtimeControl&quot;:false,&quot;constraints&quot;:{&quot;itemStyle&quot;:&quot;width: 200px;&quot;,&quot;supportNow&quot;:true,&quot;supportClear&quot;:&quot;true&quot;,&quot;args&quot;:{}}},{&quot;editorType&quot;:&quot;_dataSourceSelector&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group2&quot;,&quot;groupLabel&quot;:&quot;Metric&quot;,&quot;name&quot;:&quot;dataSource&quot;,&quot;label&quot;:&quot;Datasource&quot;,&quot;desc&quot;:&quot;VIA data source name for system model&quot;,&quot;type&quot;:&quot;object&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:{&quot;dataSource&quot;:&quot;/vitria/m3o/datasource/DefaultDomain/charter_ref_db&quot;},&quot;constraints&quot;:{&quot;type&quot;:&quot;dataSource&quot;,&quot;args&quot;:{}},&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group2&quot;,&quot;groupLabel&quot;:&quot;Metric&quot;,&quot;name&quot;:&quot;ref_table&quot;,&quot;label&quot;:&quot;System Model Table&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:&quot;true&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;viaops_parse_model&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;number&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;poll&quot;,&quot;label&quot;:&quot;Poll Rate (Minutes)&quot;,&quot;type&quot;:&quot;integer&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;1&quot;,&quot;defaultValueForExisted&quot;:&quot;1&quot;,&quot;runtimeControl&quot;:false,&quot;group&quot;:&quot;group2&quot;,&quot;groupLabel&quot;:&quot;Metric&quot;,&quot;constraints&quot;:{&quot;min&quot;:&quot;0&quot;,&quot;max&quot;:&quot;999999&quot;,&quot;step&quot;:&quot;1&quot;,&quot;places&quot;:&quot;&quot;,&quot;maxLength&quot;:&quot;&quot;,&quot;args&quot;:{}}},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group3&quot;,&quot;groupLabel&quot;:&quot;Target&quot;,&quot;name&quot;:&quot;historyFolder&quot;,&quot;label&quot;:&quot;Spark SQL Table URL&quot;,&quot;desc&quot;:&quot;Metric table data file&apos;s location folder on HDFS&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;hdfs://zhihuitest/haopu/charter/dif/warehouse/viaops_metric_chtr_email&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group3&quot;,&quot;groupLabel&quot;:&quot;Target&quot;,&quot;name&quot;:&quot;history_table_name&quot;,&quot;label&quot;:&quot;Spark SQL Table&quot;,&quot;desc&quot;:&quot;Metric table name&quot;,&quot;type&quot;:&quot;string&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;viaops_metric_chtr_email&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group3&quot;,&quot;groupLabel&quot;:&quot;Target&quot;,&quot;name&quot;:&quot;streamFolder&quot;,&quot;label&quot;:&quot;Anomaly File URL&quot;,&quot;desc&quot;:&quot;Ingestion&apos;s output file&apos;s location folder on HDFS for realtime anomaly detection&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;hdfs://zhihuitest/haopu/charter/dif/stream/viaops_metric_chtr_email&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;name&quot;:&quot;anomalyFileNamePrefix&quot;,&quot;label&quot;:&quot;Anomaly File Name Prefix&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:&quot;true&quot;,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;chtr_email_cm_inboud&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false,&quot;group&quot;:&quot;group3&quot;,&quot;groupLabel&quot;:&quot;Target&quot;},{&quot;editorType&quot;:&quot;boolean&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group1&quot;,&quot;groupLabel&quot;:&quot;Audit&quot;,&quot;name&quot;:&quot;enableAudit&quot;,&quot;label&quot;:&quot;Audit Log&quot;,&quot;desc&quot;:&quot;A flag to control whether enable audit log&quot;,&quot;type&quot;:&quot;boolean&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;true&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group1&quot;,&quot;groupLabel&quot;:&quot;Audit&quot;,&quot;name&quot;:&quot;auditUrl&quot;,&quot;label&quot;:&quot;Audit Log Table&quot;,&quot;desc&quot;:&quot;The audit table name&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:true,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;viaops_auditlog&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false},{&quot;editorType&quot;:&quot;textInput&quot;,&quot;*&quot;:{&quot;label&quot;:&quot;label&quot;,&quot;desc&quot;:&quot;desc&quot;},&quot;group&quot;:&quot;group1&quot;,&quot;groupLabel&quot;:&quot;Audit&quot;,&quot;name&quot;:&quot;agg_dropped_events&quot;,&quot;label&quot;:&quot;Dropped Events Table&quot;,&quot;type&quot;:&quot;string&quot;,&quot;optional&quot;:false,&quot;hidden&quot;:&quot;false&quot;,&quot;disabled&quot;:false,&quot;resolveProperty&quot;:false,&quot;value&quot;:&quot;viaops_droppedevents_metric_chtr_email&quot;,&quot;enumSource&quot;:&quot;&quot;,&quot;runtimeControl&quot;:false}]</Properties>
      </Flow>
    </Flows>
  </ModelInfo>
</DataPipeModel>
